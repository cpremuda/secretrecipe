"use strict";var X=function(a){var b="1.13.0",c=window[a]={constants:{},interfaces:{},components:{},registry:{},events:{},loaders:{},utils:{},getVersion:function(){return b},setOptions:function(a){a=a||{},X._.each(a,function(a,b){X.setOption(b,a)})},setOption:function(a,b){var c="viewportOptions"===a;return X._.has(X.options,a)?(X._.isObject(b)?X.options[a]=X.utils.mergeObjects(X.options[a],b,!c):X._.isArray(X.options[a])?X.options[a]=X._.union(X.options[a],b):X.options[a]=b,void X.publish(X.constants.events.kOptions+"."+a,b)):void X.trace("Invalid Option: "+a+" - ignoring",["OPTIONS"],X.log.WARN)},registerComponent:function(a,b,c){return X.registry.registerComponent(a,b,c)},getComponent:function(a){return X.registry.getComponent(a)},trace:function(){X._.isObject(console)&&X.options.logToConsole&&console.log.apply(console,arguments)},resolveDynamicData:function(a,b,c){return b=b||{},X.getComponent(X.constants.interfaces.kDataResolver).resolveDynamicData(a,b,c)}};return c}("Mojo");!function(a){var b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=Array.isArray,t=Object.keys,u=f.bind,v=function(a){return a instanceof v?a:this instanceof v?void(this._wrapped=a):new v(a)};a._=v,v.VERSION="1.6.0";var w=v.each=v.forEach=function(a,b,d){if(null==a)return a;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=v.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return;return a};v.map=v.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(w(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var x="Reduce of empty array with no initial value";v.reduce=v.foldl=v.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=v.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(w(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(x);return c},v.filter=v.select=function(a,b,c){var d=[];return null==a?d:o&&a.filter===o?a.filter(b,c):(w(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},v.every=v.all=function(a,b,d){b||(b=v.identity);var e=!0;return null==a?e:p&&a.every===p?a.every(b,d):(w(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var y=v.some=v.any=function(a,b,d){b||(b=v.identity);var e=!1;return null==a?e:q&&a.some===q?a.some(b,d):(w(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};v.contains=v.include=function(a,b){return null==a?!1:r&&a.indexOf===r?-1!=a.indexOf(b):y(a,function(a){return a===b})},v.pluck=function(a,b){return v.map(a,v.property(b))};var z=function(a){return null==a?v.identity:v.isFunction(a)?a:v.property(a)};v.sortBy=function(a,b,c){return b=z(b),v.pluck(v.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")},v.size=function(a){return null==a?0:a.length===+a.length?a.length:v.keys(a).length},v.first=v.head=v.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:h.call(a,0,b)},v.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))};var A=function(a,b,c){return b&&v.every(a,v.isArray)?i.apply(c,a):(w(a,function(a){v.isArray(a)||v.isArguments(a)?b?g.apply(c,a):A(a,b,c):c.push(a)}),c)};v.flatten=function(a,b){return A(a,b,[])},v.without=function(a){return v.difference(a,h.call(arguments,1))},v.uniq=v.unique=function(a,b,c,d){v.isFunction(b)&&(d=c,c=b,b=!1);var e=c?v.map(a,c,d):a,f=[],g=[];return w(e,function(c,d){(b?d&&g[g.length-1]===c:v.contains(g,c))||(g.push(c),f.push(a[d]))}),f},v.union=function(){return v.uniq(v.flatten(arguments,!0))},v.difference=function(a){var b=i.apply(d,h.call(arguments,1));return v.filter(a,function(a){return!v.contains(b,a)})};var B=function(){};v.bind=function(a,b){var c,d;if(u&&a.bind===u)return u.apply(a,h.call(arguments,1));if(!v.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));B.prototype=a.prototype;var e=new B;B.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},v.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},v.keys=function(a){if(!v.isObject(a))return[];if(t)return t(a);var b=[];for(var c in a)v.has(a,c)&&b.push(c);return b},v.values=function(a){for(var b=v.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},v.functions=v.methods=function(a){var b=[];for(var c in a)v.isFunction(a[c])&&b.push(c);return b.sort()},v.extend=function(a){return w(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},v.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return w(c,function(c){c in a&&(b[c]=a[c])}),b},v.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)v.contains(c,e)||(b[e]=a[e]);return b},v.defaults=function(a){return w(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},v.clone=function(a){return v.isObject(a)?v.isArray(a)?a.slice():v.extend({},a):a};var C=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof v&&(a=a._wrapped),b instanceof v&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(v.isFunction(g)&&g instanceof g&&v.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=C(a[i],b[i],c,d)););}else{for(var l in a)if(v.has(a,l)&&(i++,!(k=v.has(b,l)&&C(a[l],b[l],c,d))))break;if(k){for(l in b)if(v.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};v.isEqual=function(a,b){return C(a,b,[],[])},v.isEmpty=function(a){if(null==a)return!0;if(v.isArray(a)||v.isString(a))return 0===a.length;for(var b in a)if(v.has(a,b))return!1;return!0},v.isArray=s||function(a){return"[object Array]"==j.call(a)},v.isObject=function(a){return a===Object(a)},v.isPlainObject=function(a){return"object"==typeof a&&a.constructor==Object},w(["Arguments","Function","String","Number","Date","RegExp"],function(a){v["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),v.isArguments(arguments)||(v.isArguments=function(a){return!(!a||!v.has(a,"callee"))}),"function"!=typeof/./&&(v.isFunction=function(a){return"function"==typeof a}),v.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},v.isNull=function(a){return null===a},v.isUndefined=function(a){return void 0===a},v.has=function(a,b){return k.call(a,b)},v.noConflict=function(){return a._=b,this},v.property=function(a){return function(b){return b[a]}},v.mixin=function(a){w(v.functions(a),function(b){var c=v[b]=a[b];v.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),H.call(this,c.apply(v,a))}})};var D=0;v.uniqueId=function(a){var b=++D+"";return a?a+b:b},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},G=/\\|'|\r|\n|\t|\u2028|\u2029/g;v.template=function(a,b,c){var d;c=v.defaults({},c,v.templateSettings);var e=new RegExp([(c.escape||E).source,(c.interpolate||E).source,(c.evaluate||E).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(G,function(a){return"\\"+F[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,v);var i=function(a){return d.call(this,a,v)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i};var H=function(a){return this._chain?v(a).chain():a};v.mixin(v),w(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];v.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],H.call(this,c)}}),w(["concat","join","slice"],function(a){var b=d[a];v.prototype[a]=function(){return H.call(this,b.apply(this._wrapped,arguments))}}),v.extend(v.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}(X),X.$=function(){function a(a){return null==a?String(a):U[V.call(a)]||"object"}function b(b){return"function"==a(b)}function c(a){return null!=a&&a==a.window}function d(a){return null!=a&&a.nodeType==a.DOCUMENT_NODE}function e(b){return"object"==a(b)}function f(a){return e(a)&&!c(a)&&Object.getPrototypeOf(a)==Object.prototype}function g(a){return"number"==typeof a.length}function h(a){return D.call(a,function(a){return null!=a})}function i(a){return a.length>0?x.fn.concat.apply([],a):a}function j(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function k(a){return a in G?G[a]:G[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function l(a,b){return"number"!=typeof b||H[j(a)]?b:b+"px"}function m(a){var b,c;return F[a]||(b=E.createElement(a),E.body.appendChild(b),c=getComputedStyle(b,"").getPropertyValue("display"),b.parentNode.removeChild(b),"none"==c&&(c="block"),F[a]=c),F[a]}function n(a){return"children"in a?C.call(a.children):x.map(a.childNodes,function(a){return 1==a.nodeType?a:void 0})}function o(a,b,c){for(w in b)c&&(f(b[w])||$(b[w]))?(f(b[w])&&!f(a[w])&&(a[w]={}),$(b[w])&&!$(a[w])&&(a[w]=[]),o(a[w],b[w],c)):b[w]!==v&&(a[w]=b[w])}function p(a,b){return null==b?x(a):x(a).filter(b)}function q(a,c,d,e){return b(c)?c.call(a,d,e):c}function r(a,b,c){null==c?a.removeAttribute(b):a.setAttribute(b,c)}function s(a,b){var c=a.className,d=c&&c.baseVal!==v;return b===v?d?c.baseVal:c:void(d?c.baseVal=b:a.className=b)}function t(a){var b;try{return a?"true"==a||("false"==a?!1:"null"==a?null:/^0/.test(a)||isNaN(b=Number(a))?/^[\[\{]/.test(a)?x.parseJSON(a,!0):a:b):a}catch(c){return a}}function u(a,b){b(a);for(var c in a.childNodes)u(a.childNodes[c],b)}var v,w,x,y,z,A,B=[],C=B.slice,D=B.filter,E=window.document,F={},G={},H={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},I=/^\s*<(\w+|!)[^>]*>/,J=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,K=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,L=/^(?:body|html)$/i,M=/([A-Z])/g,N=["val","css","html","text","data","width","height","offset"],O=["after","prepend","before","append"],P=E.createElement("table"),Q=E.createElement("tr"),R={tr:E.createElement("tbody"),tbody:P,thead:P,tfoot:P,td:Q,th:Q,"*":E.createElement("div")},S=/complete/,T=/^[\w-]*$/,U={},V=U.toString,W={},Y=E.createElement("div"),Z={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},$=Array.isArray||function(a){return a instanceof Array};return W.matches=function(a,b){if(!b||!a||1!==a.nodeType)return!1;var c=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(c)return c.call(a,b);var d,e=a.parentNode,f=!e;return f&&(e=Y).appendChild(a),d=~W.qsa(e,b).indexOf(a),f&&Y.removeChild(a),d},z=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},A=function(a){return D.call(a,function(b,c){return a.indexOf(b)==c})},W.fragment=function(a,b,c){var d,e,g;return J.test(a)&&(d=x(E.createElement(RegExp.$1))),"undefined"!=typeof d&&d||(a.replace&&(a=a.replace(K,"<$1></$2>")),b===v&&(b=I.test(a)&&RegExp.$1),b in R||(b="*"),g=R[b],g.innerHTML=""+a,d=x.each(C.call(g.childNodes),function(){g.removeChild(this)})),"undefined"!=typeof d&&f(c)&&(e=x(d),x.each(c,function(a,b){N.indexOf(a)>-1?e[a](b):E.all&&E.documentMode?e[a]=b:e.attr(a,b)})),d},W.Z=function(a,b){return a=a||[],a.__proto__=x.fn,a.selector=b||"",a},W.isZ=function(a){return a instanceof W.Z},W.init=function(a,c){var d;if(!a)return W.Z();if("string"==typeof a)if(a=a.trim(),"<"==a[0]&&I.test(a))d=W.fragment(a,RegExp.$1,c),a=null;else{if(c!==v)return x(c).find(a);d=W.qsa(E,a)}else{if(b(a))return x(E).ready(a);if(W.isZ(a))return a;if($(a))d=h(a);else if(e(a))d=[a],a=null;else if(I.test(a))d=W.fragment(a.trim(),RegExp.$1,c),a=null;else{if(c!==v)return x(c).find(a);d=W.qsa(E,a)}}return W.Z(d,a)},x=function(a,b){return E.all&&E.documentMode&&"undefined"!=typeof jQuery?(jQuery.noConflict(),jQuery(a,b)):W.init(a,b)},x.extend=function(a){var b,c=C.call(arguments,1);return"boolean"==typeof a&&(b=a,a=c.shift()),c.forEach(function(c){o(a,c,b)}),a},W.qsa=function(a,b){var c,e="#"==b[0],f=!e&&"."==b[0],g=e||f?b.slice(1):b,h=T.test(g);return d(a)&&h&&e?(c=a.getElementById(g))?[c]:[]:1!==a.nodeType&&9!==a.nodeType?[]:C.call(h&&!e?f?a.getElementsByClassName(g):a.getElementsByTagName(b):a.querySelectorAll(b))},x.contains=function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},x.type=a,x.isFunction=b,x.isWindow=c,x.isArray=$,x.isPlainObject=f,x.isEmptyObject=function(a){var b;for(b in a)return!1;return!0},x.inArray=function(a,b,c){return B.indexOf.call(b,a,c)},x.camelCase=z,x.trim=function(a){return null==a?"":String.prototype.trim.call(a)},x.uuid=0,x.support={},x.expr={},x.map=function(a,b){var c,d,e,f=[];if(g(a))for(d=0;d<a.length;d++)c=b(a[d],d),null!=c&&f.push(c);else for(e in a)c=b(a[e],e),null!=c&&f.push(c);return i(f)},x.each=function(a,b){var c,d;if(g(a)){for(c=0;c<a.length;c++)if(b.call(a[c],c,a[c])===!1)return a}else for(d in a)if(b.call(a[d],d,a[d])===!1)return a;return a},x.grep=function(a,b){return D.call(a,b)},x.parseJSON=function(a,b){return X.utils.jsonSerializer.toJSON(a,b)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){U["[object "+b+"]"]=b.toLowerCase()}),x.fn={forEach:B.forEach,reduce:B.reduce,push:B.push,sort:B.sort,indexOf:B.indexOf,concat:B.concat,map:function(a){return x(x.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return x(C.apply(this,arguments))},ready:function(a){return S.test(E.readyState)&&E.body?a(x):E.addEventListener("DOMContentLoaded",function(){a(x)},!1),this},get:function(a){return a===v?C.call(this):this[a>=0?a:a+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){return B.every.call(this,function(b,c){return a.call(b,c,b)!==!1}),this},filter:function(a){return b(a)?this.not(this.not(a)):x(D.call(this,function(b){return W.matches(b,a)}))},add:function(a,b){return x(A(this.concat(x(a,b))))},is:function(a){return this.length>0&&W.matches(this[0],a)},not:function(a){var c=[];if(b(a)&&a.call!==v)this.each(function(b){a.call(this,b)||c.push(this)});else{var d="string"==typeof a?this.filter(a):g(a)&&b(a.item)?C.call(a):x(a);this.forEach(function(a){d.indexOf(a)<0&&c.push(a)})}return x(c)},has:function(a){return this.filter(function(){return e(a)?x.contains(this,a):x(this).find(a).size()})},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!e(a)?a:x(a)},last:function(){var a=this[this.length-1];return a&&!e(a)?a:x(a)},find:function(a){var b,c=this;return b=a?"object"==typeof a?x(a).filter(function(){var a=this;return B.some.call(c,function(b){return x.contains(b,a)})}):1==this.length?x(W.qsa(this[0],a)):this.map(function(){return W.qsa(this,a)}):[]},closest:function(a,b){var c=this[0],e=!1;for("object"==typeof a&&(e=x(a));c&&!(e?e.indexOf(c)>=0:W.matches(c,a));)c=c!==b&&!d(c)&&c.parentNode;return x(c)},parents:function(a){for(var b=[],c=this;c.length>0;)c=x.map(c,function(a){return(a=a.parentNode)&&!d(a)&&b.indexOf(a)<0?(b.push(a),a):void 0});return p(b,a)},parent:function(a){return p(A(this.pluck("parentNode")),a)},children:function(a){return p(this.map(function(){return n(this)}),a)},contents:function(){return this.map(function(){return C.call(this.childNodes)})},siblings:function(a){return p(this.map(function(a,b){return D.call(n(b.parentNode),function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return x.map(this,function(b){return b[a]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=m(this.nodeName))})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){var c=b(a);if(this[0]&&!c)var d=x(a).get(0),e=d.parentNode||this.length>1;return this.each(function(b){x(this).wrapAll(c?a.call(this,b):e?d.cloneNode(!0):d)})},wrapAll:function(a){if(this[0]){x(this[0]).before(a=x(a));for(var b;(b=a.children()).length;)a=b.first();x(a).append(this)}return this},wrapInner:function(a){var c=b(a);return this.each(function(b){var d=x(this),e=d.contents(),f=c?a.call(this,b):a;e.length?e.wrapAll(f):d.append(f)})},unwrap:function(){return this.parent().each(function(){x(this).replaceWith(x(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(a){return this.each(function(){var b=x(this);(a===v?"none"==b.css("display"):a)?b.show():b.hide()})},prev:function(a){return x(this.pluck("previousElementSibling")).filter(a||"*")},next:function(a){return x(this.pluck("nextElementSibling")).filter(a||"*")},html:function(a){return 0===arguments.length?this.length>0?this[0].innerHTML:null:this.each(function(b){var c=this.innerHTML;x(this).empty().append(q(this,a,b,c))})},text:function(a){return 0===arguments.length?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=a===v?"":""+a})},attr:function(a,b){var c;return"string"==typeof a&&b===v?0==this.length||1!==this[0].nodeType?v:"value"==a&&"INPUT"==this[0].nodeName?this.val():!(c=this[0].getAttribute(a))&&a in this[0]?this[0][a]:c:this.each(function(c){if(1===this.nodeType)if(e(a))for(w in a)r(this,w,a[w]);else r(this,a,q(this,b,c,this.getAttribute(a)))})},removeAttr:function(a){return this.each(function(){1===this.nodeType&&r(this,a)})},prop:function(a,b){return a=Z[a]||a,b===v?this[0]&&this[0][a]:this.each(function(c){this[a]=q(this,b,c,this[a])})},data:function(a,b){var c=this.attr("data-"+a.replace(M,"-$1").toLowerCase(),b);return null!==c?t(c):v},val:function(a){return 0===arguments.length?this[0]&&(this[0].multiple?x(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(b){this.value=q(this,a,b,this.value)})},offset:function(a){if(a)return this.each(function(b){var c=x(this),d=q(this,a,b,c.offset()),e=c.offsetParent().offset(),f={top:d.top-e.top,left:d.left-e.left};"static"==c.css("position")&&(f.position="relative"),c.css(f)});if(0==this.length)return null;var b=this[0].getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:Math.round(b.width),height:Math.round(b.height)}},css:function(b,c){if(arguments.length<2){var d=this[0],e=getComputedStyle(d,"");if(!d)return;if("string"==typeof b)return d.style[z(b)]||e.getPropertyValue(b);if($(b)){var f={};return x.each($(b)?b:[b],function(a,b){f[b]=d.style[z(b)]||e.getPropertyValue(b)}),f}}var g="";if("string"==a(b))c||0===c?g=j(b)+":"+l(b,c):this.each(function(){this.style.removeProperty(j(b))});else for(w in b)b[w]||0===b[w]?g+=j(w)+":"+l(w,b[w])+";":this.each(function(){this.style.removeProperty(j(w))});return this.each(function(){this.style.cssText+=";"+g})},index:function(a){return a?this.indexOf(x(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return a?B.some.call(this,function(a){return this.test(s(a))},k(a)):!1},addClass:function(a){return a?this.each(function(b){y=[];var c=s(this),d=q(this,a,b,c);d.split(/\s+/g).forEach(function(a){x(this).hasClass(a)||y.push(a)},this),y.length&&s(this,c+(c?" ":"")+y.join(" "))}):this},removeClass:function(a){return this.each(function(b){return a===v?s(this,""):(y=s(this),q(this,a,b,y).split(/\s+/g).forEach(function(a){y=y.replace(k(a)," ")}),void s(this,y.trim()))})},toggleClass:function(a,b){return a?this.each(function(c){var d=x(this),e=q(this,a,c,s(this));e.split(/\s+/g).forEach(function(a){(b===v?!d.hasClass(a):b)?d.addClass(a):d.removeClass(a)})}):this},scrollTop:function(a){if(this.length){var b="scrollTop"in this[0];return a===v?b?this[0].scrollTop:this[0].pageYOffset:this.each(b?function(){this.scrollTop=a}:function(){this.scrollTo(this.scrollX,a)})}},scrollLeft:function(a){if(this.length){var b="scrollLeft"in this[0];return a===v?b?this[0].scrollLeft:this[0].pageXOffset:this.each(b?function(){this.scrollLeft=a}:function(){this.scrollTo(a,this.scrollY)})}},position:function(){if(this.length){var a=this[0],b=this.offsetParent(),c=this.offset(),d=L.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(x(a).css("margin-top"))||0,c.left-=parseFloat(x(a).css("margin-left"))||0,d.top+=parseFloat(x(b[0]).css("border-top-width"))||0,d.left+=parseFloat(x(b[0]).css("border-left-width"))||0,{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||E.body;a&&!L.test(a.nodeName)&&"static"==x(a).css("position");)a=a.offsetParent;return a})}},["width","height"].forEach(function(a){var b=a.replace(/./,function(a){return a[0].toUpperCase()});x.fn[a]=function(e){var f,g=this[0];return e===v?c(g)?g["inner"+b]:d(g)?g.documentElement["scroll"+b]:(f=this.offset())&&f[a]:this.each(function(b){g=x(this),g.css(a,q(this,e,b,g[a]()))})}}),O.forEach(function(b,c){var d=c%2;x.fn[b]=function(){var b,e,f=x.map(arguments,function(c){return b=a(c),"object"==b||"array"==b||null==c?c:W.fragment(c)}),g=this.length>1;return f.length<1?this:this.each(function(a,b){e=d?b:b.parentNode,b=0==c?b.nextSibling:1==c?b.firstChild:2==c?b:null,f.forEach(function(a){if(g)a=a.cloneNode(!0);else if(!e)return x(a).remove();u(e.insertBefore(a,b),function(a){null==a.nodeName||"SCRIPT"!==a.nodeName.toUpperCase()||a.type&&"text/javascript"!==a.type||a.src||window.eval.call(window,a.innerHTML)})})})},x.fn[d?b+"To":"insert"+(c?"Before":"After")]=function(a){return x(a)[b](this),this}}),W.Z.prototype=x.fn,W.uniq=A,W.deserializeValue=t,x.zepto=W,x}(),function(a){function b(b,d){var i=b[h],j=i&&e[i];if(void 0===d)return j||c(b);if(j){if(d in j)return j[d];var k=g(d);if(k in j)return j[k]}return f.call(a(b),d)}function c(b,c,f){var i=b[h]||(b[h]=++a.uuid),j=e[i]||(e[i]=d(b));return void 0!==c&&(j[g(c)]=f),j}function d(b){var c={};return a.each(b.attributes||i,function(b,d){0==d.name.indexOf("data-")&&(c[g(d.name.replace("data-",""))]=a.zepto.deserializeValue(d.value))}),c}var e={},f=a.fn.data,g=a.camelCase,h=a.expando="Zepto"+ +new Date,i=[];a.fn.data=function(d,e){return void 0===e?a.isPlainObject(d)?this.each(function(b,e){a.each(d,function(a,b){c(e,a,b)})}):0==this.length?void 0:b(this[0],d):this.each(function(){c(this,d,e)})},a.fn.removeData=function(b){return"string"==typeof b&&(b=b.split(/\s+/)),this.each(function(){var c=this[h],d=c&&e[c];d&&a.each(b||d,function(a){delete d[b?g(this):a]})})},["remove","empty"].forEach(function(b){var c=a.fn[b];a.fn[b]=function(){var a=this.find("*");return"remove"===b&&(a=a.add(this)),a.removeData(),c.call(this)}})}(X.$),function(a){function b(a,b,c){var d=X.$.Event(b);try{X.$(a).trigger(d,c)}catch(e){}return!d.isDefaultPrevented()}function c(a,c,d,e){return a.global?b(c||s,d,e):void 0}function d(b){b.global&&0===a.active++&&c(b,null,"ajaxStart")}function e(b){b.global&&!--a.active&&c(b,null,"ajaxStop")}function f(a,b){var d=b.context;return b.beforeSend.call(d,a,b)===!1||c(b,d,"ajaxBeforeSend",[a,b])===!1?!1:void c(b,d,"ajaxSend",[a,b])}function g(a,b,d,e){var f=d.context,g="success";d.success.call(f,a,g,b),e&&e.resolveWith(f,[a,g,b]),c(d,f,"ajaxSuccess",[b,d,a]),i(g,b,d)}function h(a,b,d,e,f){var g=e.context;e.error.call(g,d,b,a),f&&f.rejectWith(g,[d,b,a]),c(e,g,"ajaxError",[d,e,a||b]),i(b,d,e)}function i(a,b,d){var f=d.context;d.complete.call(f,b,a),c(d,f,"ajaxComplete",[b,d]),e(d)}function j(){}function k(a){return a&&(a=a.split(";",2)[0]),a&&(a==x?"html":a==w?"json":u.test(a)?"script":v.test(a)&&"xml")||"text"}function l(a,b){return""==b?a:(a+"&"+b).replace(/[&?]{1,2}/,"?")}function m(b){b.processData&&b.data&&"string"!=a.type(b.data)&&(b.data=a.param(b.data,b.traditional)),!b.data||b.type&&"GET"!=b.type.toUpperCase()||(b.url=l(b.url,b.data),b.data=void 0)}function n(b,c,d,e){return a.isFunction(c)&&(e=d,d=c,c=void 0),a.isFunction(d)||(e=d,d=void 0),{url:b,data:c,success:d,dataType:e}}function o(b,c,d,e){var f,g=a.isArray(c),h=a.isPlainObject(c);a.each(c,function(c,i){f=a.type(i),e&&(c=d?e:e+"["+(h||"object"==f||"array"==f?c:"")+"]"),!e&&g?b.add(i.name,i.value):"array"==f||!d&&"object"==f?o(b,i,d,c):b.add(c,i)})}var p,q,r=0,s=window.document,t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,u=/^(?:text|application)\/javascript/i,v=/^(?:text|application)\/xml/i,w="application/json",x="text/html";a.active=0,a.ajaxJSONP=function(b,c){if(!("type"in b))return a.ajax(b);var d,e,i=b.jsonpCallback,j=(a.isFunction(i)?i():i)||"jsonp"+ ++r,k=s.createElement("script"),l=window[j],m=function(b){a(k).triggerHandler("error",b||"abort")},n={abort:m};return c&&c.promise(n),a(k).on("load error",function(f,i){clearTimeout(e),a(k).off().remove(),"error"!=f.type&&d?g(d[0],n,b,c):h(null,i||"error",n,b,c),window[j]=l,d&&a.isFunction(l)&&l(d[0]),l=d=void 0}),f(n,b)===!1?(m("abort"),n):(window[j]=function(){d=arguments},k.src=b.url.replace(/\?(.+)=\?/,"?$1="+j),s.head.appendChild(k),b.timeout>0&&(e=setTimeout(function(){m("timeout")},b.timeout)),n)},a.ajaxSettings={type:"GET",beforeSend:j,success:j,error:j,complete:j,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:w,xml:"application/xml, text/xml",html:x,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},a.ajax=function(b){var c=a.extend({},b||{}),e=a.Deferred&&a.Deferred();for(p in a.ajaxSettings)void 0===c[p]&&(c[p]=a.ajaxSettings[p]);d(c),c.crossDomain||(c.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(c.url)&&RegExp.$2!=window.location.host),c.url||(c.url=window.location.toString()),m(c),c.cache===!1&&(c.url=l(c.url,"_="+Date.now()));var i=c.dataType,n=/\?.+=\?/.test(c.url);if("jsonp"==i||n)return n||(c.url=l(c.url,c.jsonp?c.jsonp+"=?":c.jsonp===!1?"":"callback=?")),a.ajaxJSONP(c,e);var o,r=c.accepts[i],s={},t=function(a,b){s[a.toLowerCase()]=[a,b]},u=/^([\w-]+:)\/\//.test(c.url)?RegExp.$1:window.location.protocol,v=c.xhr(),w=v.setRequestHeader;if(e&&e.promise(v),c.crossDomain||t("X-Requested-With","XMLHttpRequest"),t("Accept",r||"*/*"),(r=c.mimeType||r)&&(r.indexOf(",")>-1&&(r=r.split(",",2)[0]),v.overrideMimeType&&v.overrideMimeType(r)),(c.contentType||c.contentType!==!1&&c.data&&"GET"!=c.type.toUpperCase())&&t("Content-Type",c.contentType||"application/x-www-form-urlencoded"),c.headers)for(q in c.headers)t(q,c.headers[q]);if(v.setRequestHeader=t,v.onreadystatechange=function(){if(4==v.readyState){v.onreadystatechange=j,clearTimeout(o);var b,d=!1;if(v.status>=200&&v.status<300||304==v.status||0==v.status&&"file:"==u){i=i||k(c.mimeType||v.getResponseHeader("content-type")),b=v.responseText;try{"script"==i?a.globalEval(b):"json"==i?b=a.parseJSON(b):"xml"==i&&(b=v.responseXML)}catch(f){d=f}d?h(d,"parsererror",v,c,e):g(b,v,c,e)}else h(v.statusText||null,v.status?"error":"abort",v,c,e)}},f(v,c)===!1)return v.abort(),h(null,"abort",v,c,e),v;if(c.xhrFields)for(q in c.xhrFields)v[q]=c.xhrFields[q];var x="async"in c?c.async:!0;v.open(c.type,c.url,x,c.username,c.password);for(q in s)w.apply(v,s[q]);return c.timeout>0&&(o=setTimeout(function(){v.onreadystatechange=j,v.abort(),h(null,"timeout",v,c,e)},c.timeout)),v.send(c.data?c.data:null),v},a.get=function(){return a.ajax(n.apply(null,arguments))},a.post=function(){var b=n.apply(null,arguments);return b.type="POST",a.ajax(b)},a.getJSON=function(){var b=n.apply(null,arguments);return b.dataType="json",a.ajax(b)},a.fn.loadHTML=function(b,c,d){if(!this.length)return this;var e,f=this,g=b.split(/\s/),h=n(b,c,d),i=h.success;return g.length>1&&(h.url=g[0],e=g[1]),h.success=function(b){f.html(e?a("<div>").html(b.replace(t,"")).find(e):b),i&&i.apply(f,arguments)},a.ajax(h),this};var y=encodeURIComponent;a.param=function(a,b){var c=[];return c.add=function(a,b){this.push(y(a)+"="+y(b))},o(c,a,b),c.join("&").replace(/%20/g,"+")}}(X.$),function(a){function b(c){var d=[["resolve","done",a.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",a.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",a.Callbacks({memory:1})]],e="pending",f={state:function(){return e},always:function(){return g.done(arguments).fail(arguments),this},then:function(){var c=arguments;return b(function(b){a.each(d,function(d,e){var h=a.isFunction(c[d])&&c[d];g[e[1]](function(){var c=h&&h.apply(this,arguments);if(c&&a.isFunction(c.promise))c.promise().done(b.resolve).fail(b.reject).progress(b.notify);else{var d=this===f?b.promise():this,g=h?[c]:arguments;b[e[0]+"With"](d,g)}})}),c=null}).promise()},promise:function(b){return null!=b?a.extend(b,f):f}},g={};return a.each(d,function(a,b){var c=b[2],h=b[3];f[b[1]]=c.add,h&&c.add(function(){e=h},d[1^a][2].disable,d[2][2].lock),g[b[0]]=function(){return g[b[0]+"With"](this===g?f:this,arguments),this},g[b[0]+"With"]=c.fireWith}),f.promise(g),c&&c.call(g,g),g}var c=Array.prototype.slice;a.when=function(d){var e,f,g,h=c.call(arguments),i=h.length,j=0,k=1!==i||d&&a.isFunction(d.promise)?i:0,l=1===k?d:b(),m=function(a,b,d){return function(f){b[a]=this,d[a]=arguments.length>1?c.call(arguments):f,d===e?l.notifyWith(b,d):--k||l.resolveWith(b,d)}};if(i>1)for(e=new Array(i),f=new Array(i),g=new Array(i);i>j;++j)h[j]&&a.isFunction(h[j].promise)?h[j].promise().done(m(j,g,h)).fail(l.reject).progress(m(j,f,e)):--k;return k||l.resolveWith(g,h),l.promise()},a.Deferred=b}(X.$),function(a){a.Callbacks=function(b){b=a.extend({},b);var c,d,e,f,g,h,i=[],j=!b.once&&[],k=function(a){for(c=b.memory&&a,d=!0,h=f||0,f=0,g=i.length,e=!0;i&&g>h;++h)if(i[h].apply(a[0],a[1])===!1&&b.stopOnFalse){c=!1;break}e=!1,i&&(j?j.length&&k(j.shift()):c?i.length=0:l.disable())},l={add:function(){if(i){var d=i.length,h=function(c){a.each(c,function(a,c){"function"==typeof c?b.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!=typeof c&&h(c)})};h(arguments),e?g=i.length:c&&(f=d,k(c))}return this},remove:function(){return i&&a.each(arguments,function(b,c){for(var d;(d=a.inArray(c,i,d))>-1;)i.splice(d,1),e&&(g>=d&&--g,h>=d&&--h)}),this},has:function(b){return!(!i||!(b?a.inArray(b,i)>-1:i.length))},empty:function(){return g=i.length=0,this},disable:function(){return i=j=c=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||d&&!j||(b=b||[],b=[a,b.slice?b.slice():b],e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments)},fired:function(){return!!d}};return l;
}}(X.$),function(a){function b(b){return b=a(b),!(!b.width()&&!b.height())&&"none"!==b.css("display")}function c(a,b){a=a.replace(/=#\]/g,'="#"]');var c,d,e=h.exec(a);if(e&&e[2]in g&&(c=g[e[2]],d=e[3],a=e[1],d)){var f=Number(d);d=isNaN(f)?d.replace(/^["']|["']$/g,""):f}return b(a,c,d)}var d=a.zepto,e=d.qsa,f=d.matches,g=a.expr[":"]={visible:function(){return b(this)?this:void 0},hidden:function(){return b(this)?void 0:this},enabled:function(){return this.disabled?void 0:this},disabled:function(){return this.disabled?this:void 0},selected:function(){return this.selected?this:void 0},checked:function(){return this.checked?this:void 0},parent:function(){return this.parentNode},first:function(a){return 0===a?this:void 0},last:function(a,b){return a===b.length-1?this:void 0},eq:function(a,b,c){return a===c?this:void 0},contains:function(b,c,d){return a(this).text().indexOf(d)>-1?this:void 0},has:function(a,b,c){return d.qsa(this,c).length?this:void 0}},h=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),i=/^\s*>/,j="Zepto"+ +new Date;d.qsa=function(b,f){return c(f,function(c,g,h){try{var k;!c&&g?c="*":i.test(c)&&(k=a(b).addClass(j),c="."+j+" "+c);var l=e(b,c)}catch(m){throw console.error("error performing selector: %o",f),m}finally{k&&k.removeClass(j)}return g?d.uniq(a.map(l,function(a,b){return g.call(a,b,l,h)})):l})},d.matches=function(a,b){return c(b,function(b,c,d){return(!b||f(a,b))&&(!c||c.call(a,null,d)===a)})}}(X.$),function(a){function b(a){return a._zid||(a._zid=m++)}function c(a,c,f,g){if(c=d(c),c.ns)var h=e(c.ns);return(q[b(a)]||[]).filter(function(a){return a&&(!c.e||a.e==c.e)&&(!c.ns||h.test(a.ns))&&(!f||b(a.fn)===b(f))&&(!g||a.sel==g)})}function d(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function e(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function f(a,b){return a.del&&!s&&a.e in t||!!b}function g(a){return u[a]||s&&t[a]||a}function h(c,e,h,i,k,m,n){var o=b(c),p=q[o]||(q[o]=[]);e.split(/\s/).forEach(function(b){if("ready"==b)return a(document).ready(h);var e=d(b);e.fn=h,e.sel=k,e.e in u&&(h=function(b){var c=b.relatedTarget;return!c||c!==this&&!a.contains(this,c)?e.fn.apply(this,arguments):void 0}),e.del=m;var o=m||h;e.proxy=function(a){if(a=j(a),!a.isImmediatePropagationStopped()){a.data=i;var b=o.apply(c,a._args==l?[a]:[a].concat(a._args));return b===!1&&(a.preventDefault(),a.stopPropagation()),b}},e.i=p.length,p.push(e),"addEventListener"in c&&c.addEventListener(g(e.e),e.proxy,f(e,n))})}function i(a,d,e,h,i){var j=b(a);(d||"").split(/\s/).forEach(function(b){c(a,b,e,h).forEach(function(b){delete q[j][b.i],"removeEventListener"in a&&a.removeEventListener(g(b.e),b.proxy,f(b,i))})})}function j(b,c){return(c||!b.isDefaultPrevented)&&(c||(c=b),a.each(y,function(a,d){var e=c[a];b[a]=function(){return this[d]=v,e&&e.apply(c,arguments)},b[d]=w}),(c.defaultPrevented!==l?c.defaultPrevented:"returnValue"in c?c.returnValue===!1:c.getPreventDefault&&c.getPreventDefault())&&(b.isDefaultPrevented=v)),b}function k(a){var b,c={originalEvent:a};for(b in a)x.test(b)||a[b]===l||(c[b]=a[b]);return j(c,a)}var l,m=1,n=Array.prototype.slice,o=a.isFunction,p=function(a){return"string"==typeof a},q={},r={},s="onfocusin"in window,t={focus:"focusin",blur:"focusout"},u={mouseenter:"mouseover",mouseleave:"mouseout"};r.click=r.mousedown=r.mouseup=r.mousemove="MouseEvents",a.event={add:h,remove:i},a.proxy=function(c,d){if(o(c)){var e=function(){return c.apply(d,arguments)};return e._zid=b(c),e}if(p(d))return a.proxy(c[d],c);throw new TypeError("expected function")},a.fn.bind=function(a,b,c){return this.on(a,b,c)},a.fn.unbind=function(a,b){return this.off(a,b)},a.fn.one=function(a,b,c,d){return this.on(a,b,c,d,1)};var v=function(){return!0},w=function(){return!1},x=/^([A-Z]|returnValue$|layer[XY]$)/,y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(a,b,c){return this.on(b,a,c)},a.fn.undelegate=function(a,b,c){return this.off(b,a,c)},a.fn.live=function(b,c){return a(document.body).delegate(this.selector,b,c),this},a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,b,c),this},a.fn.on=function(b,c,d,e,f){var g,j,m=this;return b&&!p(b)?(a.each(b,function(a,b){m.on(a,c,d,b,f)}),m):(p(c)||o(e)||e===!1||(e=d,d=c,c=l),(o(d)||d===!1)&&(e=d,d=l),e===!1&&(e=w),m.each(function(l,m){f&&(g=function(a){return i(m,a.type,e),e.apply(this,arguments)}),c&&(j=function(b){var d,f=a(b.target).closest(c,m).get(0);return f&&f!==m?(d=a.extend(k(b),{currentTarget:f,liveFired:m}),(g||e).apply(f,[d].concat(n.call(arguments,1)))):void 0}),h(m,b,e,d,c,j||g)}))},a.fn.off=function(b,c,d){var e=this;return b&&!p(b)?(a.each(b,function(a,b){e.off(a,c,b)}),e):(p(c)||o(d)||d===!1||(d=c,c=l),d===!1&&(d=w),e.each(function(){i(this,b,d,c)}))},a.fn.trigger=function(b,c){return b=p(b)||a.isPlainObject(b)?a.Event(b):j(b),b._args=c,this.each(function(){a(this).triggerHandler(b,c)})},a.fn.triggerHandler=function(b,d){var e,f;return this.each(function(g,h){e=k(p(b)?a.Event(b):b),e._args=d,e.target=h,a.each(c(h,b.type||b),function(a,b){return f=b.proxy(e),e.isImmediatePropagationStopped()?!1:void 0})}),f},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(b){a.fn[b]=function(a){return a?this.bind(b,a):this.trigger(b)}}),["focus","blur"].forEach(function(b){a.fn[b]=function(a){return a?this.bind(b,a):this.each(function(){try{this[b]()}catch(a){}}),this}}),a.Event=function(a,b){p(a)||(b=a,a=b.type);var c=document.createEvent(r[a]||"Events"),d=!0;if(b)for(var e in b)"bubbles"==e?d=!!b[e]:c[e]=b[e];return c.initEvent(a,d,!0),j(c)}}(X.$),function(a,b){function c(a){return a.replace(/([a-z])([A-Z])/,"$1-$2").toLowerCase()}function d(a){return e?e+a:a.toLowerCase()}var e,f,g,h,i,j,k,l,m,n,o="",p={Webkit:"webkit",Moz:"",O:"o"},q=window.document,r=q.createElement("div"),s=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,t={};a.each(p,function(a,c){return r.style[a+"TransitionProperty"]!==b?(o="-"+a.toLowerCase()+"-",e=c,!1):void 0}),f=o+"transform",t[g=o+"transition-property"]=t[h=o+"transition-duration"]=t[j=o+"transition-delay"]=t[i=o+"transition-timing-function"]=t[k=o+"animation-name"]=t[l=o+"animation-duration"]=t[n=o+"animation-delay"]=t[m=o+"animation-timing-function"]="",a.fx={off:e===b&&r.style.transitionProperty===b,speeds:{_default:400,fast:200,slow:600},cssPrefix:o,transitionEnd:d("TransitionEnd"),animationEnd:d("AnimationEnd")},a.fn.animate=function(c,d,e,f,g){return a.isFunction(d)&&(f=d,e=b,d=b),a.isFunction(e)&&(f=e,e=b),a.isPlainObject(d)&&(e=d.easing,f=d.complete,g=d.delay,d=d.duration),d&&(d=("number"==typeof d?d:a.fx.speeds[d]||a.fx.speeds._default)/1e3),g&&(g=parseFloat(g)/1e3),this.anim(c,d,e,f,g)},a.fn.anim=function(d,e,o,p,q){var r,u,v,w={},x="",y=this,z=a.fx.transitionEnd,A=!1;if(e===b&&(e=a.fx.speeds._default/1e3),q===b&&(q=0),a.fx.off&&(e=0),"string"==typeof d)w[k]=d,w[l]=e+"s",w[n]=q+"s",w[m]=o||"linear",z=a.fx.animationEnd;else{u=[];for(r in d)s.test(r)?x+=r+"("+d[r]+") ":(w[r]=d[r],u.push(c(r)));x&&(w[f]=x,u.push(f)),e>0&&"object"==typeof d&&(w[g]=u.join(", "),w[h]=e+"s",w[j]=q+"s",w[i]=o||"linear")}return v=function(b){if("undefined"!=typeof b){if(b.target!==b.currentTarget)return;a(b.target).unbind(z,v)}else a(this).unbind(z,v);A=!0,a(this).css(t),p&&p.call(this)},e>0&&(this.bind(z,v),setTimeout(function(){A||v.call(y)},1e3*e+25)),this.size()&&this.get(0).clientLeft,this.css(w),0>=e&&setTimeout(function(){y.each(function(){v.call(this)})},0),this},r=null}(X.$),function(a,b){function c(c,d,e,f,g){"function"!=typeof d||g||(g=d,d=b);var h={opacity:e};return f&&(h.scale=f,c.css(a.fx.cssPrefix+"transform-origin","0 0")),c.animate(h,d,null,g)}function d(b,d,e,f){return c(b,d,0,e,function(){g.call(a(this)),f&&f.call(this)})}var e=window.document,f=(e.documentElement,a.fn.show),g=a.fn.hide,h=a.fn.toggle;a.fn.show=function(a,d){return f.call(this),a===b?a=0:this.css("opacity",0),c(this,a,1,"1,1",d)},a.fn.hide=function(a,c){return a===b?g.call(this):d(this,a,"0,0",c)},a.fn.toggle=function(c,d){return c===b||"boolean"==typeof c?h.call(this,c):this.each(function(){var b=a(this);b["none"==b.css("display")?"show":"hide"](c,d)})},a.fn.fadeTo=function(a,b,d){return c(this,a,b,null,d)},a.fn.fadeIn=function(a,b){var c=this.css("opacity");return c>0?this.css("opacity",0):c=1,f.call(this).fadeTo(a,c,b)},a.fn.fadeOut=function(a,b){return d(this,a,null,b)},a.fn.fadeToggle=function(b,c){return this.each(function(){var d=a(this);d[0==d.css("opacity")||"none"==d.css("display")?"fadeIn":"fadeOut"](b,c)})},a.fn.slideDown=function(a){var b=this.css("position");this.show(),this.css({position:"absolute",visibility:"hidden"});var c=this.css("margin-top"),d=this.css("margin-bottom"),e=this.css("padding-top"),f=this.css("padding-bottom"),g=this.css("height");this.css({position:b,visibility:"visible",overflow:"hidden",height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0}),this.animate({height:g,marginTop:c,marginBottom:d,paddingTop:e,paddingBottom:f},a)},a.fn.slideUp=function(a){if(this.height()>0){var b=this,c=(b.css("position"),b.css("height")),d=b.css("margin-top"),e=b.css("margin-bottom"),f=b.css("padding-top"),g=b.css("padding-bottom");this.css({visibility:"visible",overflow:"hidden",height:c,marginTop:d,marginBottom:e,paddingTop:f,paddingBottom:g}),b.animate({height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0},{duration:a,queue:!1,complete:function(){b.hide(),b.css({visibility:"visible",overflow:"hidden",height:c,marginTop:d,marginBottom:e,paddingTop:f,paddingBottom:g})}})}},a.fn.slideToggle=function(a){0==this.height()?this.slideDown(a):this.slideUp(a)}}(X.$),function(a){a.fn.extend=function(b){a.extend(a.fn,b)},a.globalEval=function(b){var c,d=eval;b=a.trim(b),b&&(1===b.indexOf("use strict")?(c=document.createElement("script"),c.text=b,document.head.appendChild(c).parentNode.removeChild(c)):d(b))},a.ready=function(a){document.addEventListener?document.addEventListener("DOMContentLoaded",function(b){a(b)},!1):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",window),a(event))})}}(X.$),X.constants={events:{kInitialize:"initialize",kOptions:"options",kException:"exception",kConsoleEnabled:"debugConsoleEnabled",kConsoleDisabled:"debugConsoleDisabled",kProfile:"profile"},interfaces:{kABTestResolver:"abTestResolver",kDataResolver:"dataResolver"},jqEvents:{},scopes:{kApplicationScope:"APPLICATION_SCOPE",kFlowScope:"FLOW_SCOPE",kViewScope:"VIEW_SCOPE"},log:{INFO:"INFO",WARN:"WARN",ERROR:"ERROR",CRITICAL:"CRITICAL",DEPRECATED:"DEPRECATED"},registry:{kComponents:"components",kInterfaces:"interfaces"},kWildCard:"*",functionRegex:/^(.*?)(\((.*?)\))?$/,nameSpaceRegex:/^([^\s\r\n\'\"]+)\.([^\s\r\n\'\"]+)$/,scriptRegex:/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,expressionRegexPattern:/\@\{(.*?)\}/g,eventSeparatorMatch:/[^\s,]+/g},X.log=X.constants.log,X.options={appId:null,ABTestConfig:{},logToConsole:!0,alertOnExceptions:!0,exceptionAlerts:[X.log.CRITICAL,X.log.ERROR,X.log.WARN]},function(){var a=/xyz/.test(function(){return"xyz"})?/\b_super\b/:/.*/,b=!1;X.Class=function(){},X.Class.extend=function c(d){function e(){b||this.construct&&this.construct.apply(this,arguments)}var f=this.prototype;b=!0;var g=new this;b=!1;for(var h in d)g[h]="function"==typeof d[h]&&"function"==typeof f[h]&&a.test(d[h])?function(a,b){return function(){var c=this._super;this._super=f[a];var d=b.apply(this,arguments);return this._super=c,d}}(h,d[h]):d[h];return e.prototype=g,e.prototype.constructor=e,e.extend=c,e}}(),X.registry={_register:function(a,b,c,d){var e=this._createOrFindNameSpace(a);if(X._.has(e,b)){if(d)return X.trace("registerComponent: Component '"+b+"' already exists. Not replacing","Registry",X.log.INFO),e[b];X.publishException("X.registry","Replacing component named: "+b,X.log.INFO),delete e[b]}return e[b]=c,c},_get:function(a,b){return this._registry[a]?X._.isUndefined(b)?null:this._registry[a][b]||null:(X.trace("Request for "+a+" : "+b+" does not exist","Registry",X.log.INFO),null)},_getAll:function(a){return this._registry[a]?this._registry[a]:null},_getNames:function(a){return this._registry[a]?X._.keys(this._registry[a]):[]},_remove:function(a,b){this._registry[a]&&delete this._registry[a][b]},_has:function(a,b){return this._registry[a]&&this._registry[a][b]?!0:!1},_createOrFindNameSpace:function(a){return this._registry[a]||(this._registry[a]={}),this._registry[a]},_publishException:function(a){X.publishException("Registry",a,X.log.WARN)},_registry:{}},X._.extend(X.registry,{registerComponent:function(a,b,c){return this._register(X.constants.registry.kComponents,a,b,c)},getComponent:function(a){return this._get(X.constants.registry.kComponents,a)}}),X.registerComponent(X.constants.interfaces.kDataResolver,{resolveDynamicData:function(a){return a}},!1),X.utils.jsonSerializer=function(){var a={toString:function(a){if(X._.isString(a))return a;if(window.JSON)return JSON.stringify(a);var b=typeof a;if("object"!=b||null===a)return"string"==b&&(a='"'+a+'"'),String(a);var c,d,e=[],f=a&&a.constructor==Array;for(c in a){if(d=a[c],b=typeof d,"string"==b)d='"'+d+'"';else if("object"==b&&null!==d)d=this.toString(d);else if("function"==b)continue;e.push((f?"":'"'+c+'":')+String(d))}return(f?"[":"{")+String(e)+(f?"]":"}")},toJSON:function(a,b,c){if("string"!=typeof a||!a)return a;var d={};a.trim(),a=a.replace(/\0$/,"");try{d=window.JSON&&!b?JSON.parse(a):new Function("return "+a)()}catch(e){X.publishException("X.utils.jsonSerializer","Invalid JSON\n"+a,X.log.ERROR,e)}return c?X.utils.jsonSerializer.decodeJSONObj(d):d}};return a}(),X._.extend(X.utils,{get$:function(a){return X.$.zepto.isZ(a)?a:"undefined"!=typeof jQuery&&a instanceof jQuery?X.$(a[0]):X._.isString(a)?X.$("#"+a):X.$(a)},extend_$:function(a){X.$.fn.extend(a),"undefined"!=typeof jQuery&&jQuery.fn.extend(a)}}),function(a){a.extend(a.support,function(){var a,b,c=document.createElement("input"),d="search number range color tel url email date month week time datetime datetime-local",e="autocomplete autofocus list placeholder max min multiple pattern required step";return{inputtypes:function(){var e=d.split(" "),f={};for(a=0,b=e.length;b>a;a++)c.setAttribute("type",e[a]),f[e[a]]="text"!==c.type;return f}(),input:function(){var d=e.split(" "),f={};for(a=0,b=d.length;b>a;a++)f[d[a]]=!!(d[a]in c);return f}()}}())}(X.$),X.utils.extend_$({scrollTo:function(a,b){function c(a,b,c,d){return a/=d/2,1>a?c/2*a*a+b:(a-=1,-c/2*(a*(a-2)-1)+b)}var d=this,e=d.scrollTop(),f=a-e,g=20,h=function(a){a+=g;var i=c(a,e,f,b);d.scrollTop(i),b>a&&setTimeout(function(){h(a)},g)};h(0)},isTextInput:function(){var a="text password hidden search number color tel url email date month week time datetime datetime-local".split(" "),b=X.$(this);return b.is("textarea")?!0:b.is("input")&&X._.contains(a,b.attr("type"))?!0:!1},isUserInputElement:function(){var a=X.$(this);return a.is("input")||a.is("select")||a.is("textarea")},caret:function(a,b){var c,d=/text|password|search|tel|url/.test(this[0].type);if(!d)return{begin:0,end:0};if(0!==this.length&&!this.is(":hidden")){if("number"==typeof a){var e="number"==typeof b?b:a;return this.each(function(){this.setSelectionRange?this.setSelectionRange(a,e):this.createTextRange&&(c=this.createTextRange(),c.collapse(!0),c.moveEnd("character",e),c.moveStart("character",a),c.select())})}return this[0].setSelectionRange?(a=this[0].selectionStart,b=this[0].selectionEnd):document.selection&&document.selection.createRange&&(c=document.selection.createRange(),a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length),{begin:a,end:b}}},detach:function(a){var b=this.get(0);X.unsubscribeIf(function(c){if(c&&(1===c.nodeType||3===c.nodeType)){if(a&&X.$.contains(b,c)&&b!==c)return X.$(c).off(),!0;if(!a&&(X.$.contains(b,c)||c===b))return X.$(c).off(),!0}return!1})}}),X.events.Events=function(){var a=X._,b={on:function(b,c,e,f){var g=this;if(!b||!c)return X.publishException("PubSub","Invalid subscribe: missing event name or callback "),g;var h=b.match(X.constants.eventSeparatorMatch);return a.each(h,function(a){var b=d(a);g._events=g._events||{},g._events[b.type]||(g._events[b.type]=[]),g._events[b.type].push({type:b.type,namespace:b.namespace,callback:c,context:e,ctx:e||g,param:f})}),g},off:function(b,c,e){var f,g,h,i,j,k;if(!this._events)return this;if(!b&&!c&&!e)return this._events={},this;var l=this,m=b?b.match(X.constants.eventSeparatorMatch):a.keys(this._events);return a.each(m,function(a){var b=d(a);if(i=[b.type],h=l._events[i]){for(l._events[i]=f=[],j=0,k=h.length;k>j;j++)g=h[j],c&&c!==g.callback&&c!==g.callback._callback||e&&e!==g.context?f.push(g):b.namespace&&(!g.namespace||(g.namespace+".").indexOf(b.namespace+".")<0)&&f.push(g);f.length||delete l._events[i]}}),this},debug:function(b){var c=0;return a.each(this._events,function(d,e){c+=d.length,a.isFunction(b)&&a.each(d,function(a){b(a)})}),c},once:function(b,c,d,e){if(!c)return this;var f=this,g=a.once(function(){f.off(b,g),c.apply(this,arguments)});return g._callback=c,this.on(b,g,d,e)},offIfContextCondition:function(b){var c,d,e;if(!a.isFunction(b)||!this._events)return this;d=a.keys(this._events);for(var f=0;f<d.length;f++)e=d[f],c=this._events[e],c&&(this._events[e]=X._.filter(this._events[e],function(a){var c=b(a.context);return!c}),this._events[e]||delete this._events[e]);return this},trigger:function(b){var e;if(!this._events)return this;var f=[].slice.call(arguments,1),g=d(b);e=g.namespace?a.filter(this._events[g.type],function(a){return!a.namespace||0===(g.namespace+".").indexOf(a.namespace+".")}):a.filter(this._events[g.type],function(a){return!a.namespace});var h=this._events.all;return e&&c(e,f),h&&c(h,arguments),this},stopListening:function(a,b,c){var d=this._listeners;if(!d)return this;var e=!b&&!c;"object"==typeof b&&(c=this),a&&((d={})[a._listenerId]=a);for(var f in d)d[f].off(b,c,this),e&&delete this._listeners[f];return this}},c=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1];b[2];switch(b.length){case 0:for(;++d<e;)c=a[d],c.param?c.callback.call(c.ctx,c.param):c.callback.call(c.ctx);return;case 1:for(;++d<e;)c=a[d],c.param?c.callback.call(c.ctx,f,c.param):c.callback.call(c.ctx,f);return;case 2:for(;++d<e;)c=a[d],c.param?c.callback.call(c.ctx,f,g,c.param):c.callback.call(c.ctx,f,g);return;default:for(;++d<e;)if(c=a[d],c.param){var h=b.slice().concat(c.param);c.callback.apply(c.ctx,h)}else c.callback.apply(c.ctx,b)}},d=function(b){var c,d,e;return void 0===b?{}:(a.isString(b)||(b=b.toString()),c=b.indexOf("."),c>=0?(e=b.substr(c),d=b.substr(0,c)):(e=void 0,d=b),{type:d,namespace:e})},e={listenTo:"on",listenToOnce:"once"};return a.each(e,function(c,d){b[d]=function(b,d,e){var f=this._listeners||(this._listeners={}),g=b._listenerId||(b._listenerId=a.uniqueId("l"));return f[g]=b,"object"==typeof d&&(e=this),b[c](d,e,this),this}}),b}(),X.events.exception=X.Class.extend({construct:function(a,b,c,d){this.component=a,this.msg=b,this.logType=c?c:X.log.ERROR,this.exeptionObj=d,this.context=[]},addContext:function(a){this.context.push(a)},toString:function(){return"Exception: "+this.msg}}),X.Exception=X.events.exception,X.events.pubsub=function(){var a=X._.clone(X.events.Events),b={subscribe:function(b,c,d,e){a.off(b,c,d),a.on(b,c,d,e)},once:function(b,c,d,e){a.once(b,c,d,e)},unsubscribe:function(b,c,d){b&&(X._.isObject(b)?a.off(null,null,b):a.off(b,c,d))},unsubscribeIf:function(b){"function"==typeof b&&a.offIfContextCondition(b)},publish:function(b){var c=[].slice.call(arguments);a.trigger.apply(a,c),X.trace("Event published: "+arguments[0],"EVENT")},debug:function(b){return a.debug(b)}};return b}(),X.events=X.events||{},X._.extend(X,X.events.pubsub),X._.extend(X,{publishException:function(a,b,c,d){a instanceof X.Exception?X.publish(X.constants.events.kException,a):X.publish(X.constants.events.kException,new X.Exception(a,b,c||X.log.ERROR,d))},publishEvent:function(){X.publish.call(X.events.pubsub,arguments)},subscribeForEvent:function(){X.subscribe.call(X.events.pubsub,arguments)}}),X.subscribe(X.constants.events.kException,function(a){if(!a)return void X.trace("Exception thrown with no data.");var b="Application ("+X.options.appId+") "+a.logType+": Component="+a.component+" Msg="+a.msg;a.exeptionObj&&(b+="\nCaused by:\n"+a.exeptionObj.message),X.options.alertOnExceptions&&X._.contains(X.options.exceptionAlerts,a.logType)&&alert(b)},X),X.loaders.CssLoader=function(){function a(a){for(var b=0;b<document.styleSheets.length;b++){var c=document.styleSheets[b].href,d=a.replace(new RegExp("\\.\\./","g"),"");if(c&&-1!==c.indexOf(d))return!0}return!1}var b={load:function(b,c,d){if(a(b))X.trace("CSS Already Loaded: "+b,"CssLoader");else{var e=document.getElementsByTagName("head")[0],f=document.createElement("link");f.setAttribute("href",b),f.setAttribute("rel","stylesheet"),f.setAttribute("type","text/css"),f.setAttribute("id",c?c:""),f.setAttribute("media",d?d:"screen"),e.appendChild(f),X.trace("CSS Loaded: "+b,"CssLoader")}return X.$.Deferred().resolve().promise()}};return b}(),X.loaders.HTMLLoader=function(){function a(a,e){X._.each(a,function(a){try{if(c(a)||!b(a)){var f=X.$(a),g=f.attr("id");if(g){var h=document.getElementById(g);h&&h.nodeName===f.get(0).nodeName&&h.type===f.get(0).type&&h.parentNode.removeChild(h)}X.$("body").append(a)}else{var i=a.substring(a.indexOf(">")+1,a.lastIndexOf("<"));X.$.globalEval(i)}}catch(j){d("Failed to evaluate scripts in: "+e,j)}},this)}function b(a){var b=a.substring(0,a.indexOf(">")+1);return!/ type/i.test(b)||/javascript/i.test(b)||/ecmascript/i.test(b)}function c(a){var b=a.substring(0,a.indexOf(">")+1);return/ src\s*=/i.test(b)}function d(a,b){X.publishException("HTMLLoader","Error Details: "+a,X.log.ERROR,b)}var e={load:function(a,b){var c=X.$.Deferred();return X.$.ajax({url:a,success:function(e){if(b){var f,g=X.$(e);f=g.attr("id")===b?g:g.find("#"+b).filter("#"+b),f.length>0?e=f[0].outerHTML:d("Error loading HTML: '"+a+"' could not find the Hash: '"+b+"' in Page: "+a)}c.resolve(e)},error:function(b,e,f){var g=new X.Exception("HTMLLoader","Error Details: Error loading HTML page: "+a+"  Status: "+b.status+" Details: "+e,X.log.ERROR);d("Error loading HTML page: "+a+"  Status: "+b.status+" Details: "+e,f),c.reject(g)}}),c.promise()},injectHTML:function(b){var c,d=b.html,e=d.replace(X.constants.scriptRegex,""),f=d.match(X.constants.scriptRegex);a(f,b.ref),b.container&&(c=X.utils.get$(b.container),c.html(e))}};return e}(),X.loaders.JSONLoader=function(){var a={load:function(a){var b=X.$.Deferred();return X.$.ajax({url:a,dataType:"json",success:function(a){var c;c="string"==typeof a?X.utils.jsonSerializer.toJSON(a):a,b.resolve(c)},error:function(c,d,e){var f;f="parsererror"===d?new X.Exception("JSONLoader","Parse Error: "+a+" - Context: "+e,X.log.ERROR):new X.Exception("JSONLoader","Load Error: "+a+" - Context: "+e,X.log.ERROR),b.reject(f)}}),b.promise()}};return a}(),X.loaders.JSLoader=function(){function a(){for(var a=document.getElementsByTagName("script"),b=0;b<a.length;b++)if(a[b].src.length>0){var e=a[b].src;e=e.substring(e.lastIndexOf("/")+1,e.length),c.push(e)}d=!0}var b={load:function(b){var e=X.$.Deferred(),f=!1;d||a();for(var g=0;g<c.length;g++){var h=b.substring(b.lastIndexOf("/")+1,b.length);if(c[g]==h){X.trace("Script Already Loaded: "+b,"JSLoader"),f=!0,e.resolve(!0);break}}return f||X.$.ajax({type:"GET",url:b,dataType:"script",success:function(a,d,f){try{X.trace("Script Loaded: "+b,"JSLoader"),c.push(b),e.resolve(!0)}catch(g){X.publishException("JSLoader","Failed to execute loaded script: "+b,X.log.ERROR,g),e.reject()}},error:function(a,c,d){X.publishException("JSLoader","Failed to load script: "+b,X.log.ERROR,d),e.reject()}}),e.promise()}},c=[],d=!1;return b}(),Date.prototype.yyyymmdd=function(){var a=this.getFullYear().toString(),b=(this.getMonth()+1).toString(),c=this.getDate().toString();return a+(b[1]?b:"0"+b[0])+(c[1]?c:"0"+c[0])},String.prototype.toNum=function(a){if(this&&this.length>0){var b="-"===this.charAt(0),c=this.replace(/[^0-9.]/gi,"");return c=parseFloat(c),isNaN(c)?NaN:b?0-c:c}return a?0:null},String.prototype.toDate=function(){var a=this.match(/(\d{2})[\/|\-](\d{2})[\/|\-](\d{4})/);return a?new Date(a[3],a[1]-1,a[2]):(a=this.match(/(\d{4})[\/|\-](\d{2})[\/|\-](\d{4})/))?new Date(a[1],a[2]-1,a[3]):(a=this.match(/(\d{2})[\/|\-](\d{4})/))?new Date(a[2],a[1]-1,1):(a=this.match(/(\d{2})[\/|\-](\d{2})/),a?new Date("20"+a[2],a[1]-1,1):this.match(/\d{4}/)?new Date(this,0,1):new Date(this))},String.prototype.trim||(String.prototype.trim=function(){return this&&this.length>0?this.replace(/^[\s]+|[\s]+$/g,""):""}),String.prototype.removeQuotes=function(){return 0!==this.length?this.replace(/^["|'](.*?)["|']$/,"$1"):void 0},X.utils.Profiler=function(a){var b={reset:function(){f=new Date,d={},e={}},mark:function(a,b){d[a]=b?b:new Date},captureTimeFromMark:function(a,b){b?e[a]=new Date-d[b]:e[a]=new Date-f},getCapture:function(a){return e[a]},setName:function(a){c=a},getName:function(){return c},serialize:function(){return c+" : "+X.utils.jsonSerializer.toString(e)}},c=a,d={},e={},f=new Date;return b},X._.extend(X.utils,{uuid:function(a){for(var b=[],c="0123456789abcdef",d=0;36>d;d++)b[d]=c.substr(Math.floor(16*Math.random()),1);b[14]="4",b[19]=c.substr(3&b[19]|8,1),b[8]=b[13]=b[18]=b[23]="-";var e=b.join(""),f=e.split("-");return a?f[f.length-1]:e}}),X._.extend(X.utils,{stringToFunction:function(a,b){for(var c=a.split("."),d=b||window,e=0,f=c.length;f>e;e++)if(d=d[c[e]],"undefined"==typeof d)return void 0;return d},evaluateSimpleOperand:function(a){var b=function(a){return a.match(/^\[(.*?)\]$/)||a.match(/^\{(.*?)\}$/)};if(!a)return a;var c=a;if(c=X.resolveDynamicData(c),X._.isString(c)&&b(c)&&(c=X.utils.jsonSerializer.toJSON(c,!0)),"true"===c)return!0;if("false"===c)return!1;if(c&&"string"==typeof c){try{c=decodeURIComponent(c)}catch(d){}if(isNaN(c.replace(/\,/g,""))){var e=c.match(/^'(.*)'$/)||c.match(/^"(.*)"$/);return e?e[1]:c}return parseFloat(c.replace(/\,/g,""))}return c},replaceCharWithinParenthesis:function(a,b,c){for(var d="",e=0,f=0;f<a.length;f++){var g=a.charAt(f);"("===g?e+=1:")"===g&&(e=Math.max(e-1,0)),d+=g===b&&e>0?c:g}return d},getArrayOfArgs:function(a){function b(a){for(var b="",c=0,d=0,e=0;e<a.length;e++){var f=a.charAt(e);"'"===f&&0===d?c=1-c:'"'===f&&0===c&&(d=1-d),b+=","===f&&(c>0||d>0)?"_comma_":f}return b}if(!a||0===a.length)return[];if(a=b(a),a=a.replace(/\s*,\s*/g,",").replace(/^\s*/,"").replace(/\s*$/,""),0===a.length)return null;for(var c=a.split(","),d=0;d<c.length;d++)c[d]=c[d].replace(/_comma_/g,","),c[d]=X.utils.evaluateSimpleOperand(c[d]);return c}}),X._.extend(X.utils,{isElementCompletelyInView:function(a){var b=X.utils.get$(a)[0],c=b.getBoundingClientRect();return c.top>=0&&c.left>=0&&c.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&c.right<=(window.innerWidth||document.documentElement.clientWidth)},isElementInView:function(a){var b=X.utils.get$(a)[0],c=b.getBoundingClientRect();return c.top>=0&&c.left>=0},isElementTopInView:function(a){var b=X.utils.get$(a)[0],c=b.getBoundingClientRect();return c.top>=0},htmlEscape:function(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlUnescape:function(a){return String(a).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}}),X._.extend(X.utils,{mergeObjects:function(a,b,c){var d=X._.extend({},a);return X._.each(b,function(a,b){try{!X._.isObject(a)||X._.isArray(a)||X._.isFunction(a)||X._.isRegExp(a)?d[b]=a:d[b]=X.utils.mergeObjects(d[b],a,c)}catch(e){c||(d[b]=a)}}),d},manipulateStringsInObj:function(a,b){function c(a){return X._.isObject(a)?(X._.each(a,function(a,b,d){d[b]=c(d[b])}),a):X._.isString(a)?b(a):a}return X._.each(a,function(a,b,d){d[b]=c(d[b])}),a},decodeJSONObj:function(a){this.manipulateStringsInObj(a,function(a){return decodeURIComponent(a)})}}),X.components.ABTestResolver=function(){this.setABTests=function(d){var e={},f=X._.isObject(d)?d:{};if(X.removeModel("ABTest"),c=!1,X._.isString(d)){var g=d.split("&");X._.each(g,function(a){var b=a.split("=");2===b.length&&(f[b[0]]=b[1])})}a={},b.tests&&(X._.each(f,function(d,f){a[f]=d,b.tests[f]&&b.tests[f][d]&&(c=!0,X._.each(b.tests[f][d].vars,function(a,b){e[b]?X.publishException("abTestResolver","Conflicting ABTest variable: "+b):e[b]=a}))}),X.data.ABTestModel&&X.registry.registerModel(new X.data.ABTestModel(e)))},this.getABTestPage=function(e,f){if(!c)return null;var g=b.testRoot||"",h=null;return X._.each(a,function(a,c){if(b.tests[c]&&b.tests[c][a]&&X._.isArray(b.tests[c][a].views)){var i=b.tests[c][a].views;X._.contains(i,e)&&!h&&(h=g+"/"+c+"/"+a+"/"+d(f))}}),h},this.getABTestFlow=function(e,f){if(!c)return null;var g=b.testRoot||"",h=null;return X._.each(a,function(a,c){if(b.tests[c]&&b.tests[c][a]&&X._.isArray(b.tests[c][a].flows)){var i=b.tests[c][a].flows;X._.contains(i,e)&&!h&&(h=g+"/"+c+"/"+a+"/"+d(f))}}),h};var a={},b=X.options.ABTestConfig||{},c=!1,d=function(a){var c=b.mainRoot;return c&&0!==c.length?(/\/$/.test(c)||(c+="/"),0!==a.indexOf(c)?a:a.substr(c.length)):a};X.subscribe(X.constants.events.kOptions+".ABTestConfig",function(){b=X.options.ABTestConfig},this)},X.$.ready(function(){X.registerComponent(X.constants.interfaces.kABTestResolver,new X.components.ABTestResolver,!0)}),X.flow=X.flow||{},X.application={},X.view={binder:{}},X.ui={},X.uiComponents={},X.debug={},X._.extend(X,{registerUIComponentClass:function(a,b){return X.registry.registerUIComponentClass(a,b)},registerCustomBinder:function(a,b,c){return X.registry.registerCustomBinder(a,b,c)},registerViewport:function(a,b,c){return X.registry.registerViewport(a,new X.view.ViewController(a,b),c)},getContainingViewport:function(a){var b=X.utils.get$(a);return X.application.Controller.getContainingViewport(b)},setABTests:function(a){var b=X.getComponent(X.constants.interfaces.kABTestResolver);b||(b=X.registerComponent(X.constants.interfaces.kABTestResolver,new X.components.ABTestResolver)),b.setABTests(a)},getSome:function(a,b){return X.init(),X.application.Controller.startFlow(a,b)},loadPage:function(a,b){return X.init(),X.application.Controller.loadPage(a,b)},showModal:function(a,b){b=b||{};var c={};c.modal=b,X.init(),X.application.Controller.loadPage(a,c)},doNext:function(a,b){b=b||{},b.nav=a;var c=b.viewport||X.options.defaultViewport;X.publish(X.constants.events.kNavigation+"."+c,b)},doJump:function(a,b){b=b||{},b.jump=a;var c=b.viewport||X.options.defaultViewport;X.publish(X.constants.events.kNavigation+"."+c,b)},applyBindings:function(a,b){return X.bindings.bindContainer(a,b)},unbind:function(a,b){X.bindings.unbindContainer(a,b),X.publish(X.constants.events.kBindingsRemoved)}}),X.startFlow=X.getSome,X.constants=X.utils.mergeObjects(X.constants,{eventDirectives:["data-nav","data-jump","data-event","data-loadflow","data-loadpage","data-set","data-href"],appDirectives:["data-mojo-app","data-viewport","data-bind","data-validate","data-format","data-listen","data-repeat","data-template"],events:{kNavigation:"navigation",kBeforePageLoad:"beforePageLoad",kPageLoaded:"pageLoaded",kPageFinalized:"pagefinal",kBeforePageUnload:"endPage",kBindingsApplied:"bindingsApplied",kBindingsRemoved:"bindingsRemoved",kTemplateReady:"templateReady",kEndViewController:"endViewController"},interfaces:{kViewResolver:"viewResolver",kTemplateEngine:"templateEngine",kScreenTransitioner:"screenTransitioner",kModalWindow:"modalWindow"},registry:{kViewports:"viewports",kUIComponents:"uiComponents",kTemplates:"templates",kCustomBinderPre:"customBinderPre",kCustomBinderPost:"customBinderPost"}}),X.constants.allDirectives=X._.union(X.constants.appDirectives,X.constants.eventDirectives),
X.constants.allOptions=X._.map(X.constants.allDirectives,function(a){return a+"-options"}),X.constants.allDirectives=X._.union(X.constants.allDirectives,X.constants.allOptions),X._.extend(X.options,{viewResolverOptions:{pathToViews:{"default":"views"},aliasMap:{"*":".html"},cacheParam:null},defaultViewport:null,viewportOptions:{"default":{scrollToTop:!0,scrollOptions:{toViewport:!1,isAnimated:!1,animationDuration:100},setFocusOnFirstInput:!0,setFocusInputTypes:["input","select","textarea","button"],screenTransitionerClass:"X.components.ScreenTransitioner",viewportHistory:{enableTracking:!1,autoBackNavigationEvent:null,historySize:null,allowDuplicates:!1},validationOptions:{},formatOptions:{}}},enableTraceConsole:!0}),X.$.ready(function(){var a=X.options;a.viewportOptions["default"].validationOptions=a.validationOptions,a.viewportOptions["default"].formatOptions=a.formatOptions}),X.view.I_UiComponent=X.Class.extend({interfaceType:"uiComponent",create:function(a,b){throw new X.Exception("X.view.I_UiComponent","must implement 'create' function: ",X.log.ERROR)},update:function(a){throw new X.Exception("X.view.I_UiComponent","must implement 'update' function: ",X.log.ERROR)},_copyDataAttributes:function(a,b){for(var c=0;c<a[0].attributes.length;c++){var d=a[0].attributes[c];"name"!=d.name&&"data"!=d.name&&"dataFormatAs"!=d.name&&"implementation"!=d.name&&b.attr(d.name,d.value)}"disabled"!==a.attr("disabled")&&b.removeAttr("disabled")}}),X.debug.console=function(){function a(){var a=!1;X.$(document).on("mousedown","#debug_menu_bar",function(b){a=!0,b.preventDefault()}),X.$(document).on("mouseup",function(){a=!1}),X.$(window).on("mousemove",function(b){if(a!==!1){var c=X.$(window).height(),d=c-b.clientY;X.$("#debug_console_body").height(d),X.$("#debug_console_viewport").height(d-80)}})}function b(a){s.push(a)}function c(a){var b=X.$.inArray(a,s);-1!=b&&s.splice(b,1)}function d(a){for(var b=0;b<s.length;b++)if("*"===s[b]||X._.contains(a,s[b]))return!1;return!0}function e(){k||(X.$("body").append(m),i.addPanel({label:"Mojo Trace",id:"debugconsole_menu",$el:o,setAsDefault:!0}),n=X.$("#debug_console_viewport"),k=!0),X.$(m).show()}function f(){i.send('<span class="delimiter">---------------------------------------------------</span>')}function g(){n.empty()}var h={},i={enable:function(a){j=X._.isUndefined(a)?!0:!!a,j?(e(),X.publish(X.constants.events.kConsoleEnabled),X.subscribe(X.constants.events.kException,i.handleXException,i)):(X.publish(X.constants.events.kConsoleDisabled),X.$(m).hide(),X.unsubscribe(X.constants.events.kException,i.handleXException,i))},openWindow:function(){j&&(X.$("#debug_console_body").slideDown(500),l=!0,X.$("#debug_console_toggle_button").text("close"))},closeWindow:function(){j&&k&&(X.$("#debug_console_body").slideUp(500),l=!1,X.$("#debug_console_toggle_button").text("debug"))},toggleWindow:function(){l?this.closeWindow():this.openWindow()},addCommand:function(a,b){h[a]=b},removeCommand:function(a){delete h[a]},send:function(a,e,f){if(j){try{if(f&&"object"==typeof console&&X.options.logToConsole)switch(f){case X.log.WARN:console.warn?console.warn(a,e):console.log(a,e);break;case X.log.DEPRECATED:console.warn?console.warn("DEPRECATED: "+a,e):console.log(a,e);break;case X.log.ERROR:case X.log.CRITICAL:console.error?console.error(a,e):console.log(a,e);break;case X.log.INFO:console.info?console.info(a,e):console.log(a,e)}}catch(g){}if(a+="<br />",e&&e.length>0){if("string"==typeof e&&(e=e.split(",")),X._.contains(r,e[0])){var h=e[0],i=h.replace(/ /g,"_");r.push(e[0]),X.$("<div style='padding:4px 10px;border-width:0 0 1px;border-style:solid;border-color:#222;background-color:#333;margin-top:1px;'><input type='checkbox' id='"+i+"_checkbox' data-component-name='"+h+"' checked /><label for='"+i+"_checkbox' style='padding-left:5px;'>"+h+"</label></div>").appendTo("#debug_console_component_list"),X.$("#"+i+"_checkbox").change(function(){var a=X.$(this).prop("checked"),d=X.$(this).attr("data-component-name");a?c(d):b(d)})}if(!d(e))return;a='<span style="color:green;">['+e.join("][")+"]</span> "+a}if(f)switch(f){case X.log.WARN:a='<span style="color:orange;">- WARNING -</span> '+a;break;case X.log.ERROR:a='<span style="color:red;">- ERROR -</span> '+a;break;case X.log.INFO:a='<span style="color:blue;">- INFO -</span> '+a;break;case X.log.CRITICAL:a='<span style="color:#ff2aec;">- CRITICAL -</span> '+a;break;case X.log.DEPRECATED:a='<span style="color:yellow;">- DEPRECATED -</span> '+a}p=a+p,null!==n&&-1===q&&(q=setTimeout(function(){try{var a=X.$("<span>"+p+"</span>");n.prepend(a),p="",q=-1}catch(b){}},500))}},clearWindow:function(){g()},sendDelimeter:function(){f()},addPanel:function(a){if(!a)throw new X.Exception("debugConsole","cannot add panel without options",X.log.WARN);var b=a.label,c=a.id,d=a.htmlpage||a.htmlPage,e=a.$el;if(!b||!c)throw new X.Exception("debugConsole","cannot add panel without label and id",X.log.WARN);if(!d&&!e)throw new X.Exception("debugConsole","cannot add panel without a dom element or fileName",X.log.WARN);if(!(X.$("#"+c).length>0)){var f=X.$('<button id="'+c+'_button" class="debug_tab">'+b+"</button>");m.find("#debug_menu_bar").append(f),f.on("click",i.onMenuButtonClick);var g=X.$('<div id="'+c+'" class="debug_panel_off"></div>');m.find("#debug_content").append(g),e?g.append(e):document.all&&document.documentMode&&!X._.isUndefined(jQuery)?g.load(d):g.loadHTML(d),a.bind&&X.applyBindings(g),a.setAsDefault&&f.click()}},onMenuButtonClick:function(a){var b=a.target,c=X.$(b).attr("id"),d=c.replace(/_button/g,"");X.$(".debug_tab_on").removeClass("debug_tab_on"),X.$(b).addClass("debug_tab_on"),X.$(".debug_panel_on").removeClass("debug_panel_on").addClass("debug_panel_off"),X.$("#"+d).addClass("debug_panel_on").removeClass("debug_panel_off")},handleXException:function(a){if(a&&j){var b="Component="+a.component+" Msg="+a.msg;a.exeptionObj&&(b+="\nCaused by:\n"+a.exeptionObj.message),i.send(b,null,a.logType)}}};X.subscribe(X.constants.events.kInitialize,function(){i.enable(document.all&&document.documentMode?!1:X.options.enableTraceConsole)});var j=!1,k=!1,l=!1,m=null,n=null,o=null,p="",q=-1,r=[],s=[];return document.all&&document.documentMode||!X.options.enableTraceConsole||a(),function(){var a='<div id="debug_console_wrapper"><span id="debug_console_toggle_button" title="Toggle" onclick="X.debug.console.toggleWindow()">debug</span><div id="debug_console_body"><div id="debug_menu_bar"></div><div id="debug_content"></div></div></div>';m=X.$(a);var b='<span id="debug_console_viewport"> </span><span id="debug_help"><div id="debug_help_inner_container"><b>Top-level Components:</b><div id="debug_console_component_list"></div></div></span><div class="debug_clear"></div><div id="debug_console_tools"><span class="debug_console_button" title="Add a Delimeter" onclick="X.debug.console.sendDelimeter()">Delimit</span><span class="debug_console_button" title="Add a Delimeter" onclick="X.debug.console.clearWindow()">Clear</span><div class="debug_clear"></div></div>';o=X.$(b)}(),i}(),X.debug=X.debug||{},X._.extend(X,{enableTraceConsole:X.debug.console.enable,openConsole:X.debug.console.openWindow,closeConsole:X.debug.console.closeWindow,addDebugPanel:X.debug.console.addPanel,trace:X.debug.console.send}),X.application.Controller=function(){function a(a){a||(a=X.options.defaultViewport);var b=X.registry.getViewport(a);return b||c(new X.Exception("X.application.Controller","No default viewport specified in options",X.log.ERROR)),i=a,b}function b(a){var b=a||{},c=a.closeCallback;b.closeCallback=function(a){h=!1,d.isFunction(c)&&c(a)},g.show(b),h=!0}function c(a){var b;b=a instanceof X.Exception?a:new X.Exception("UNKNOWN EXCEPTION",a.type+" "+a.message,X.log.ERROR,a),X.publishException(b)}var d=X._,e={init:function(){f=X.utils.uuid(),g=X.getComponent(X.constants.interfaces.kModalWindow),X.addModel(X.constants.scopes.kApplicationScope)},getContainingViewport:function(a){var b=a.attr("data-viewport"),c=X.registry._getNames(X.constants.registry.kViewports);if(b&&d.contains(c,b))return b;var e=d.map(c,function(a){return"[data-viewport='"+a+"']"}).join(","),f=a.closest(e);return b=f?f.attr("data-viewport"):null},startFlow:function(c,e){e=e||{},e.options=e.options||{};var f;if(e.modal){var h=i;e.modal.closeEvent=X.constants.events.kEndViewController+"."+g.getViewPortId(),e.modal.closeCallback=function(a){i=h,a||f.forceEnd(),a=a||{},a.error&&d.isFunction(e.error)&&e.error(a.response),d.isFunction(e.complete)&&e.complete(a.response)},b(e.modal),e.viewport=g.getViewPortId(),f=a(e.viewport),f.startFlow(c,{modal:!0,options:e.options||{},inputVars:e.inputVars})}else f=a(e.viewport),f.startFlow(c,{modal:!1,options:e.options,inputVars:e.inputVars,complete:e.complete,error:e.error})},loadPage:function(c,e){var f;e=e||{},e.modal?(e._flowNode&&(e.modal.closeEvent=X.constants.events.kNavigation,e.modal.closeCallback=function(a){d.isFunction(e.complete)&&e.complete(a)}),b(e.modal),e.viewport=g.getViewPortId(),f=a(e.viewport),f.loadPage(c,e),e.modal.autoClose&&e.modal.autoClose.time&&setTimeout(function(){g.hide({nav:e.modal.autoClose.nav})},e.modal.autoClose.time)):(f=a(e.viewport),f.loadPage(c,e))},inModal:function(){return h},forceEnd:function(b){b||(c(new X.Exception("X.application.Controller","forceEnd: No viewport specified in options - using default",X.log.INFO)),b=X.options.viewPortId);var d=a(b);d.forceEnd()},getSessionId:function(){return f},getCurrentFlowVariable:function(b,c){var d=b||i,e=a(d);return e.getCurrentFlowVariable(c)},getCurrentFlowScopeName:function(b){var c=b||i,d=a(c);if(d){var e=d.getCurrentFlowScopeName();return e||(d=a(),e=d.getCurrentFlowScopeName()),e}},getCurrentViewScopeName:function(b){var c=b||i,d=a(c);return d.getCurrentViewScopeName()}},f=null,g=null,h=!1,i=null;return e}(),function(){X.$.ready(function(){b=!0,setTimeout(function(){var a=X.$("[data-mojo-app]");if(a.length){var b=a.attr("data-mojo-app"),c=a.attr("data-mojo-app-options"),d={};c&&(d=X.utils.stringToFunction(c),X._.isObject(d)||(X.publishException("X.application","Invalid or missing Options file specified in data-mojo-app-options: "+c+".  Using default options"),d={})),d.appId=b||d.appId,X.init(d)}else X.init()},0)}),X.init=function(d){return d&&!X._.isObject(d)&&(X.publishException("X.application","Init. Invalid Options file: must be an object"),d=null),d&&X.setOptions(d),b?a?c.resolve():(a=!0,X.application.Controller.init(),X.publish(X.constants.events.kInitialize),X.applyBindings(X.$("html")),c.resolve()):c.promise()};var a=!1,b=!1,c=X.$.Deferred()}(),X.bindings=function(){var a=X.$,b={bindContainer:function(b,c){c=c||{};var d=a.Deferred(),e=X.utils.get$(b);return X.view.binder.executeCustomBinders(e,!0,c),X.view.binder.bindRepeater(e,c).then(function(){X.view.binder.bindTemplate(e,c).then(function(){X.view.binder.bindViewports(e,c),X.view.binder.bindComponents(e,c),X.view.binder.bindEvents(e,c),X.data.binder.bindAttributes(e,c),X.data.binder.bindText(e,c),X.data.binder.bindData(e,c),X.validation.binder.bindValidators(e,c.validationOptions),X.validation.binder.bindFormatters(e,c.formatOptions),X.view.binder.executeCustomBinders(e,!1,c),c.silent||X.publish(X.constants.events.kBindingsApplied,c),d.resolve()})}),d.promise()},unbindContainer:function(b,c){var d=X.utils.get$(b);d.detach(c),a("*[data-viewport]",d).each(function(b,c){var d=a(c),e=d.attr("data-viewport");X.registry.removeViewport(e)})}};return b}(),X.components.ModalWindow=function(){var a,b,c,d="x_modal_window",e="_selfClose",f=X.$("#modalBgContainer");f[0]||setTimeout(function(){X.$("<div></div>",{id:"modalBgContainer"}).appendTo("body").hide()},0),this.show=function(d){var f=this;d=d||{},X.registerViewport(this.getViewPortId()),this.create(),a=d.closeCallback;var g=X.$("#modalContainer"),h=X.$("#modalClose"),i=X.$("#modalBgContainer"),j=X.$(window);if(d.closeButton?(h.on("click",function(){f.hide(e)}),h.show(0)):(h.off("click"),h.hide(0)),g.is(":hidden")){var k=parseInt(j.height(),10),l=parseInt(g.height(),10),m=parseInt(k/2-2*l,10);5>m&&(m=5),g.fadeIn().removeClass("xModalHide").addClass("xModalShow"),i.css({display:"block"})}d.closeEvent&&(b=d.closeEvent,X.subscribe(d.closeEvent,this.hide,this)),c=d.blockCloseWhenErrors},this.hide=function(b){var d=X.$("#modalContainer"),f=X.$("#modalClose"),h=X.$("#modalBgContainer");if(c&&b!=e){var i=X.registry.getViewport(this.getViewPortId());if(i&&!i.validate())return}else g();X.unsubscribe(this),X.registry.removeViewport(this.getViewPortId()),f.off("click"),d.remove(),h.hide(),X._.isFunction(a)&&a(b),a=null},this.create=function(){var a=X.$("#modalContainer");a[0]||(a=X.$("<div />",{id:"modalContainer"}).appendTo("body").hide(),X.$("<div data-viewport='"+d+"'></div>").appendTo(a),X.$("<div></div>",{id:"modalClose"}).appendTo(a).hide())},this.getViewPortId=function(){return d};var g=function(){X.removeErrorTips(d)}},X.registerComponent(X.constants.interfaces.kModalWindow,new X.components.ModalWindow,!0),X.components.ScreenTransitioner=function(){this.show=function(a){var b=a.callback;a.options||{};a.$target?a.$target.fadeIn(200,b):b&&b()},this.hide=function(a){a.options||{};a.$target?a.$target.fadeOut(200,function(){a.callback&&a.callback()}):a.callback&&a.callback()}},X._.extend(X.registry,{registerViewport:function(a,b,c){var d=this.getViewport(a);return d&&!c&&(X.trace("Viewport: "+a+" already registered -- deleting old one"),d.deinitilaize()),d&&c?d:(d=this._register(X.constants.registry.kViewports,a,b,c),d.init(),d)},getViewport:function(a){return this._get(X.constants.registry.kViewports,a)},removeViewport:function(a){var b=this._get(X.constants.registry.kViewports,a);b&&(b.deinitilaize(),this._remove(X.constants.registry.kViewports,a))},registerCustomBinder:function(a,b,c){this._register(c?X.constants.registry.kCustomBinderPre:X.constants.registry.kCustomBinderPost,a,b)},getCustomBinders:function(a){return this._getAll(a?X.constants.registry.kCustomBinderPre:X.constants.registry.kCustomBinderPost)}}),X.view.ViewController=function(a,b){function c(a){a=a||{},a.currentPage=z;var b=u.validationOptions;if(r.isBusy())return void X.trace("Not navigating while Flow Controller is busy");var c=!0;if(a.hasOwnProperty("validate")&&a.validate===!1&&(c=!1),!a.nav||"back"!==a.nav&&a.nav!==B||a.hasOwnProperty("validate")!==!1?a.jump&&a.hasOwnProperty("validate")===!1?c=b.validateOnJump:a.load&&a.hasOwnProperty("validate")===!1?c=b.validateOnJump:a.flow&&a.hasOwnProperty("validate")===!1&&(c=b.validateOnJump):c=b.validateOnBack,!c||r.validate())if(a.nav)if(v&&a.nav===B){var d=v.processBack(a);r.doJump(d.jump,d)}else r.doNext(a.nav,a);else a.jump?r.doJump(a.jump,a):a.load?r.loadPage(a.load,a):a.flow&&r.startFlow(a.flow,a)}function d(b,c,d){function i(a){o.empty().append(a.contents()),e(!0,c),h(b,c);var f=c.scrollTo;if(f){var g=q("#"+f);g[0]?g.scrollTo(0,200):n("Page Request: '"+b+"' could not find the Hash: '"+f)}C.captureTimeFromMark("total"),X.trace("Navigation Time: "+C.getCapture("navTime")+"ms, Load Time: "+C.getCapture("loadTime")+"ms, Binding Time: "+C.getCapture("bindTime")+"ms, Total Time: "+C.getCapture("total")+"ms",["PROFILE",b]),C.setName(b),X.publish(X.constants.events.kProfile,C),D.reset(),D.setName(b),D.mark("timeOnPage"),d(null,{})}return c=c||{},o=o||q("[data-viewport='"+a+"']"),C.captureTimeFromMark("navTime","nav"),F?(f(b,c),C.mark("load"),void t.resolve(b).then(function(a){var d=a;d=d.replace(/FLOW_SCOPE/g,r.getCurrentFlowScopeName()),d=d.replace(/VIEW_SCOPE/g,y);var e=q("<div></div>");X.loaders.HTMLLoader.injectHTML({container:e,html:d,ref:b}),C.captureTimeFromMark("loadTime","load"),z=b,g(b,c);try{C.mark("bind"),X.applyBindings(e,p.extend(u,{viewscope:y,flowscope:r.getCurrentFlowScopeName()})).then(function(){C.captureTimeFromMark("bindTime","bind"),i(e)})}catch(f){n("Error binding page",f),i(e)}},function(a){d(a)})):void X.trace("_loadContent returning without loading page because the busy flag is not set")}function e(a,b,c){E&&(a?E.show({$target:o,options:b,callback:c}):E.hide({$target:o,options:b,callback:c}))}function f(a,b){X.publish(X.constants.events.kBeforePageLoad,{pageAlias:a}),y=X.constants.scopes.kViewScope+"_"+X.utils.uuid(!0),window[y]={},X.addModel(y)}function g(a,b){if(window[y]){var c=X.getModel(y);if(c&&(c._model=window[y]),"function"==typeof window[y].onStart)try{X.trace("Calling onStart for page: "+a),window[y].onStart()}catch(d){n("Page: '"+a+"' threw an exception onStart",d)}}X.publish(X.constants.events.kPageLoaded,{pageAlias:a,viewscope:y})}function h(a,b){var c=p.isBoolean(b.setFocusOnFirstInput)?b.setFocusOnFirstInput:u.setFocusOnFirstInput;if(c){var d=p.isArray(u.setFocusInputTypes)?u.setFocusInputTypes.join(","):"";if(d){var e=o.find(d).filter(function(a){return q(this).is(":visible")&&q(this).is(":enabled")&&X.utils.isElementCompletelyInView(this)});e[0]&&e[0].focus()}}if(window[y]&&"function"==typeof window[y].onReady)try{X.trace("Calling onReady for page: "+a),window[y].onReady()}catch(f){n("Page: '"+a+"' threw an exception onReady",f)}X.publish(X.constants.events.kPageFinalized,{pageAlias:a,viewscope:y,pageProfile:C})}function i(a,b){if(C.reset(),C.mark("nav"),!z)return void b();q("input:focus").trigger("blur");var c=p.isBoolean(a.scrollToTop)?a.scrollToTop:u.scrollToTop||u.scrollOptions.toViewport;if(c&&!X.utils.isElementTopInView(o)){var d=o.offset().top-100;u.scrollToTop&&(d=0),q("body").scrollTo(d,200),q("html").scrollTo(d,200)}if(D.captureTimeFromMark("customerTime","timeOnPage"),X.trace("Customer time on page: "+D.getCapture("customerTime")+"ms",["PROFILE",z]),X.publish(X.constants.events.kProfile,D),X.publish(X.constants.events.kBeforePageUnload,{pageAlias:z,customerProfile:D}),window[y]&&"function"==typeof window[y].onEnd)try{X.trace("Calling onEnd for page: "+z),window[y].onEnd()}catch(f){n("Page: '"+z+"' threw an exception onEnd",f)}X.removeErrorTips(o),X.unsubscribe(window[y]),X.removeModel(y,{silent:!0}),X.unbind(o),window[y]=null,a._samePage||a.noTransition?b():e(!1,a,b)}function j(a,b){i({noTransition:!0},function(){z=null,s=null,X.publish(X.constants.events.kEndViewController+"."+x,{viewport:x,response:a}),p.isFunction(b)&&b()})}function k(a){e(!0,{}),s.pause(),F=!0;var b=null,c=a.modal.navWhenDone;c&&"string"==typeof c&&(c=[c]);var f=X.getModel(s.getCurrentFlowScopeName()).getAll(),g={inputVars:p.extend(p.extend({},f),a.inputVars),modal:a.modal};switch(p.each(a.options,function(a,b){g[a]=b}),g.complete=function(e){var f=e?e.value||e.nav:null;e&&(p.contains(c,f)||p.contains(c,X.flow.constants.kWildCard))&&(b=f),s.resume(b,function(b){d(b.value,a.options,function(){F=!1})})},a.state_type){case X.flow.constants.kFlowState:X.getSome(a.value,g);break;case X.flow.constants.kViewState:g._flowNode=a,g._flowscopeName=r.getCurrentFlowScopeName(),X.loadPage(a.value,g)}}function l(a){a.error instanceof X.Exception?X.publishException(a.error):X.publishException("View Controller",a.error)}function m(){var a=q.extend(!0,{},X.options.viewportOptions["default"]);"object"==typeof X.options.viewportOptions[x]&&(a=X.utils.mergeObjects(a,X.options.viewportOptions[x])),u=X.utils.mergeObjects(u,a),u.viewport=x}function n(a,b){X.publishException("ViewController","Viewport error: "+x+" - "+a,X.log.ERROR,b)}var o,p=X._,q=X.$,r={init:function(){var a=X.resolveDynamicData(u.getSome||u.loadFlow),b=u.loadFlowOptions||u.getSomeOptions,d=u.loadPage,e=u.loadPageOptions;p.omit(u,["getSome","loadFlow","loadPage","getSomeOptions","loadPageOptions","loadFlowOptions"]),m();var f=u.viewportHistory||{};if(f.enableTracking&&(B=f.autoBackNavigationEvent,B?(v=new X.view.ViewportHistory(x,f),v.start()):n("History enabled but no back event specified")),u.screenTransitionerClass){var g=X.utils.stringToFunction(u.screenTransitionerClass);E=new g}X.subscribe(X.constants.events.kNavigation+"."+x,c,r),setTimeout(function(){a?r.startFlow(a,b):d&&r.loadPage(d,e)},0)},deinitilaize:function(){X.unsubscribe(r),j(),v&&(v.stop(),v=null)},isBusy:function(){return s?s.isBusy():!1},startFlow:function(a,b){function c(){s=new X.flow.Controller({context:x,onEndCB:function(a){j(a,function(){p.isFunction(b.complete)&&b.complete(a)})},onErrorCB:function(a){l(a,function(){p.isFunction(b.error)&&b.error(a)})},onModalCB:k}),r.doJump(a,b.options,b.inputVars)}b=b||{},b.options=b.options||{},A=b.modal,s?(X.trace("Starting flow with existing controller - deleting current flow",X.log.INFO),j(null,c)):c()},loadPage:function(a,b){b=b||{},A=b.modal,b._samePage=a==z,w=b._flowscopeName,i(b,function(){F=!0,d(a,b,function(a,c){return F=!1,a&&b.error?b.error(a):void(b.success&&b.success(c))})})},doNext:function(a,b){i(b,function(){if(s){F=!0;var c=!1,e=function(a){d(a.value,b,function(c,d){G.handleAutoNav(a.autoNav,b)})};s.getNextView(a,function(a){c?i(b,function(){e(a)}):e(a),c=a.data.messageNode})}})},doJump:function(a,b,c){return a?void i(b,function(){"string"==typeof a&&(a=a.split(X.flow.constants.kNavigationSeperator),p.each(a,function(d,e){0===e?a[e]=new X.flow.NavigationObject(d,c,b):a[e]=new X.flow.NavigationObject(d)})),F=!0;var e=!1,f=function(a){d(a.value,b,function(c,d){G.handleAutoNav(a.autoNav,b)})};s.navigateTo(a,function(a){e?i(b,function(){f(a)}):f(a),e=a.data.messageNode})}):void n("doJump: No path specified")},validate:function(){var a=!0;if(!u.validationOptions.useValidator)return a;var b=X.validation.engine,c=p.extend({},u.validationOptions);if(window[y]&&window[y].validationOptions&&(c=p.extend(c,window[y].validationOptions)),a=b.validateAll(o,c),a&&window[y]&&"function"==typeof window[y].onValidate)try{X.trace("Calling onValidate for page: "+z),a=window[y].onValidate()}catch(d){n("Page: '"+z+"' threw an exception onValidate",d)}return a},getCurrentFlowVariable:function(a){return s?s.getCurrentFlowVariable(a):void 0},getCurrentFlowScopeName:function(){return s?s.getCurrentFlowScopeName():w?w:void 0},getCurrentViewScopeName:function(){return y},forceEnd:function(a){j(null,a)}},s=null,t=X.getComponent(X.constants.interfaces.kViewResolver),u=b||{},v=null,w=null,x=a,y=null,z=null,A=!1,B=null,C=new X.utils.Profiler("VIEW_PROFILE"),D=new X.utils.Profiler("CUSTOMER_TIME"),E=null,F=!1;t||n("Missing view resolver");var G=function(){function a(){r.doNext(e.nav,b)}var c,d={handleAutoNav:function(b,f){e.navEvent&&X.unsubscribe(e.navEvent,a,d),c&&clearTimeout(c),e=p.clone(b||{}),e.navEvent?X.subscribe(e.navEvent,a,d):e.time&&(c=setTimeout(function(){a()},e.time))}},e={};return d}();return r},X.view.ViewportHistory=function(a,b){function c(a){a.modal=a.modal||X.application.Controller.inModal(),0!==j&&(f&&(j&&h.length==j&&(h.shift(),X._.each(i,function(a,b){0>=a?delete i[b]:i[b]=a-1})),h.push(f),f=null),m(a)&&(f=a),a.stateDef.state_type===X.flow.constants.kFlowState&&(a.stateDef.history===X.flow.constants.historyType.kNever||a.modal)&&(i[a.stateDef.ref]=h.length.toString()))}function d(a){if(i[a.name]){var b=parseInt(i[a.name],10);h[b]&&h[b].name===a.name&&h.splice(b,h.length-b),delete i[a.name]}else{var c=a.id,d=X.getModel(c);if(d){var e=d.serialize();g[c]=e,X.trace("VIEW HISTORY - captured flow '"+a.name+"' ending with flowscope: "+e)}else X.trace("viewHistory component could not find flowscoped model for flow: '"+a.name+"'",X.log.WARN)}}var e={start:function(){X.subscribe(X.constants.events.kFlowTransition+"."+l,c,e),X.subscribe(X.constants.events.kFlowEnd+"."+l,d,e)},stop:function(a){a&&e.clear(),X.unsubscribe(e)},clear:function(){f=null,h=[],g={}},serialize:function(){var a={flowscopes:g,history:h,current:f};return X.utils.jsonSerializer.toString(a)},deserialize:function(a){var b=X.utils.jsonSerializer.toJSON(a);g=b.flowscopes,h=b.history,f=b.current},pop:function(){h.length>0&&h.pop()},processBack:function(a){if(h.length){f=null;for(var b=h.pop();!k&&b.stateDef.ref==a.currentPage;)b=h.pop();var c=[],d=b.metaData.path,e=function(a){var b=null,d=X.getModel(a.id);d?(b=d.serialize(),b=X.utils.jsonSerializer.toJSON(b)):g[a.id]&&(b=X.utils.jsonSerializer.toJSON(g[a.id])),c.push(new X.flow.NavigationObject(a.nodeName,b,{modal:a.modal,forceFlowId:a.id}))};X._.each(d,function(a,b){e(a)}),e(b);var i=a||{};return i.jump=c,i}return{}}},f=null,g={},h=[],i={},j=null,k=b.allowDuplicates,l=a;X._.isNumber(b.historySize)&&(j=parseInt(b.historySize),j=j>0?j:0);var m=function(a){switch(a.stateDef.state_type){case X.flow.constants.kActionState:return a.stateDef.history===X.flow.constants.historyType.kAlways;case X.flow.constants.kViewState:return a.stateDef.history!==X.flow.constants.historyType.kNever;default:return!1}};return e},X.view.binder=function(){var a=X._,b=X.$,c={bindViewports:function(a){var b=X.utils.get$(a);X.$("*[data-viewport]",b).each(function(a,b){var c=X.$(b),d=c.attr("data-viewport"),e=c.attr("data-viewport-options");e=X.utils.jsonSerializer.toJSON(e,!0)||{},X.registerViewport(d,e),X.options.defaultViewport=X.options.defaultViewport||d})},bindRepeater:function(c,d){var e=b.Deferred(),f=X.utils.get$(c),g=b(f).find("[data-repeat]");return 0===g.length?e.resolve():(g.each(function(){var c=b(this),f=c.attr("data-repeat-options");f=X.utils.jsonSerializer.toJSON(f,!0)||{};var g=X.utils.parseRepeatAttr(c);if(g){X.utils.renderRepeater(c,g,f.customArgs),e=X.view.binder.bindTemplate(c,d);var h=[];a.each(g.bindings,function(a,b){h.push(X.constants.events.kDataChange+"."+b)});var i=c.attr("data-listen");i&&(i=i.match(/([\.\w]+)/g),h=a.union(i,h)),i=h.join(","),a.size(i)>0&&X.subscribe(i,function(){var a=arguments[arguments.length-1],c=X.utils.parseRepeatAttr(a.$el),e=document.activeElement?document.activeElement.id:null;if(X.unbind(a.$el,!0),g.collection=c.collection,X.utils.renderRepeater(a.$el,g,f),X.applyBindings(a.$el,d),e&&e!=document.activeElement.id){var h=b("#"+e);h.focus();try{h.val&&h.caret(h.val().length)}catch(i){}}},c[0],{$el:c,info:g})}else e.resolve()}),e.promise())},bindEvents:function(a,c){var e=X.utils.get$(a);b(d,e).each(function(){b(this).bindEvents(e,c)})},bindComponents:function(a,c){var d=X.utils.get$(a);b(d).find("uiwidget").each(function(){var a=X.view.componentFactory.create(b(this));b(this).replaceWith(a)})},bindTemplate:function(a,c,d){c=c||{};var g,h=X.getComponent(X.constants.interfaces.kViewResolver),i=b.Deferred(),j=[],k=X.utils.get$(a);return h?(g=!d&&k.attr("data-template")?k:k.find("[data-template]"),0===g.length?i.resolve():(g.each(function(){var a=b(this),d=X.resolveDynamicData(a.attr("data-template")),g=d.lastIndexOf("#");if(0===g){var i=b(d);i.is("script")?e(a,i,c):a.empty().append(i.contents().clone()),j.push(b.Deferred().resolve()),X.publish(X.constants.events.kTemplateReady+"."+d.substr(1))}else if(d){var k=b.Deferred();h.resolve(d).then(function(g){var h=[];if(c.viewport){var i=X.registry.getViewport(c.viewport);i&&(g=g.replace(/FLOW_SCOPE/g,i.getCurrentFlowScopeName()),g=g.replace(/VIEW_SCOPE/g,i.getCurrentViewScopeName()))}f(g)?e(a,b(g).filter("script"),c):(X.loaders.HTMLLoader.injectHTML({container:a,html:g,ref:d}),h.push(X.view.binder.bindRepeater(a,c)),h.push(X.view.binder.bindTemplate(a,c,!0))),b.when.apply(b,h).always(function(){k.resolve()}),X.publish(X.constants.events.kTemplateReady+"."+d)},function(a){k.reject(),X.publishException("Bindings","Error Details: Unable to load data-template. Template Reference: "+d)}),j.push(k)}else X.trace("Template reference is NULL",X.log.INFO)}),b.when.apply(b,j).always(function(){i.resolve()}),i.promise())):(X.publishException("X.bindings","Missing View Resolver"),i.reject("Missing View Resolver"))},executeCustomBinders:function(b,c,d){var e=X.utils.get$(b),f=X.registry.getCustomBinders(c);f&&a.each(f,function(b,c){a.isFunction(b)&&b(e,d)})}},d=a.map(X.constants.eventDirectives,function(a){return"*["+a+"]"}).join(","),e=function(b,c,d){var e=c.attr("type");if(!e||/javascript|ecmascript/i.test(e))return void X.publishException("X.bindings","Wrong type of template for binding: "+c.attr("id"));var f,g=X.getComponent(X.constants.interfaces.kTemplateEngine),h={},i=b.attr("data-template-options");i&&(f=X.resolveDynamicData(i,h),f=X.utils.jsonSerializer.toJSON(f,!0)),g.process(b,c,f);var j=b.attr("data-listen"),k=a.map(a.keys(h),function(a){return"dataChange."+a});k=a.union(k,j?j.match(X.constants.eventSeparatorMatch):[]),k&&(b[0].templateListener||(b[0].templateListener=function(c){b[0];X.unbind(b,!0),X.applyBindings(b,a.extend(d,{silent:!0,skipTemplates:!0}))},a.each(k,function(a){X.subscribe(a,b[0].templateListener,b[0])})))},f=function(a){var b=a.replace(/<!--[\s\S]*?-->/g,""),c=b.match(/<.*?>/);if(!c)return!1;var d=c[0],e=!/type.*=/i.test(d)||/javascript|ecmascript/i.test(d);return!e};return c}(),X.view.componentFactory=function(){var a={create:function(a){var b=a.attr("data"),c=null;try{b&&(c=X.resolveDynamicData(c),c=X.utils.attributeUtil.toJSON(b,!0))}catch(d){X.publishException("componentFactory","could not parse data specification: "+b,X.log.ERROR,d)}var e=a.attr("name"),f=X.registry.createUIComponent(e);return f?f.create(a,c):void X.publishException("componentFactory","The specified component "+f+" is not found in the list of registered components")}};return a}(),X.components.TemplateEngineUnderscore=function(){var a=[];this.process=function(b,c,d){try{var e=c.html();a[e]||(a[e]=1);var f=X._.template(e);b.html(f(d))}catch(g){X.publishException("TemplateEngineUnderscore",g.message,X.log.ERROR,g)}}},X.registerComponent(X.constants.interfaces.kTemplateEngine,new X.components.TemplateEngineUnderscore,!0),X.components.ViewResolver=function(){function a(a){var b,f="default",g=a,h=null,i=X.getComponent(X.constants.interfaces.kABTestResolver),j=null,k=g.split("#");g=k[0],b=k[1];var l=X.constants.nameSpaceRegex.exec(g);l&&(f=l[1],g=l[2]),h=c[f],h||(h=c["default"]),h.match(/\/$/)||(h+="/"),d[a]?(j=d[a],X.trace("ALIAS REF: '"+a+"' --> "+j,["VIEW RESOLVER"])):d[X.constants.kWildCard]&&(j=g+d[X.constants.kWildCard],X.trace("WILDCARD REF: '"+g+"' --> "+j,["VIEW RESOLVER"])),j&&(h+=j,X.trace("FULL PATH RESOLUTION: '"+a+"' --> "+h,["VIEW RESOLVER"]));var m=i?i.getABTestPage(a,h):null;m&&(X.trace(a+" --> "+m,["VIEW RESOLVER","ABTEST"]),h=m);var n="function"==typeof e?e():e;if("string"==typeof n){var o=h.indexOf("?")>=0?"&":"?";h+=o+n}return{path:h,hash:b||""}}function b(){var a=X.options.viewResolverOptions;if(!a)throw new X.Exception("View Resolver","missing options",X.log.ERROR);if(a.cacheParam&&(e=a.cacheParam),"object"==typeof a.pathToViews){c=a.pathToViews;for(var b in c)for(var f;null!==(f=/\$\{(.*?)\}/g.exec(c[b]));){if(!c.hasOwnProperty(f[1]))throw new X.Exception("View Resolver",f[0]+" variable cannot be found.",X.log.ERROR);var g=c[f[1]];c[b]=c[b].replace(f[0],g)}if("string"!=typeof c["default"])throw new X.Exception("View Resolver","pathToViews must contain a 'default' entry.",X.log.ERROR)}else{if("string"!=typeof a.pathToViews)throw new X.Exception("View Resolver","pathToView is invalid.  Must be an object or string.",X.log.ERROR);c={"default":a.pathToViews}}if("object"!=typeof a.aliasMap)throw new X.Exception("View Resolver","aliasMap is invalid.  Must be an object",X.log.ERROR);d=a.aliasMap}this.resolve=function(b){var c=a(b);return X.loaders.HTMLLoader.load(c.path,c.hash)},this.resolveHref=function(b){var c=a(b);return c.path+(c.href?"#"+c.href:"")};var c,d,e;b(),X.subscribe(X.constants.events.kOptions+".viewResolverOptions",b,this)},X.$.ready(function(){X.registerComponent(X.constants.interfaces.kViewResolver,new X.components.ViewResolver,!0)}),X.utils.extend_$({bindEvents:function(a,b){function c(a,b){var c=!1;return function(){c||(a.apply(b?b:f,Array.prototype.slice.call(arguments,0)),c=!0),setTimeout(function(){c=!1},500)}}function d(a){a.$el=f,a.context=h||X.application.Controller.getContainingViewport(f)||X.options.defaultViewport,a.eventId=g}var e,f=X.$(this),g=X.utils.uuid(),h="object"==typeof b?b.viewport:null;if(f.prop("eventList",[]),f[0].xEventClickHandler=f[0].xEventClickHandler||function(a){var b=X.$(this);b.attr("disabled")||X._.each(b.prop("eventList"),function(c,d){c.call(b,a)})},f.off("click",f[0].xEventClickHandler).on("click",f[0].xEventClickHandler),f.attr("data-event")&&(e=f.attr("data-event-options"),
e=X.utils.jsonSerializer.toJSON(e,!0)||{},f.prop("event-options",e),f.prop("eventList").push(function(){var a=X.resolveDynamicData(f.attr("data-event")),b=f.prop("event-options");b=X.resolveDynamicData(b),d(b),X.publish(a,b)})),f.attr("data-set")){var i=f.attr("data-set"),j=X.utils.attributeUtil.toJSON(i,!0)||{};f.prop("eventList").push(function(){X._.each(j,function(a,b){var c=X.resolveDynamicData(b),d=X.resolveDynamicData(a),e=X.utils.splitDataRef(c);X.setDataVal(e.modelName,e.key,d)})})}f.attr("data-loadflow")?(e=f.attr("data-loadflow-options"),e=X.utils.jsonSerializer.toJSON(e,!0)||{},f.prop("loadflow-options",e),f.prop("eventList").push(c(function(a){var b=f.prop("loadflow-options");b=X.resolveDynamicData(b),b.flow=X.resolveDynamicData(f.attr("data-loadflow")),d(b),a.preventDefault(),X.publish(X.constants.events.kNavigation+"."+(e.viewport||b.context),b)}))):f.attr("data-loadpage")?(e=f.attr("data-loadpage-options"),e=X.utils.jsonSerializer.toJSON(e,!0)||{},f.prop("loadpage-options",e),f.prop("eventList").push(c(function(a){var b=f.prop("loadpage-options");b=X.resolveDynamicData(b),b.load=X.resolveDynamicData(f.attr("data-loadpage")),d(b),a.preventDefault(),X.publish(X.constants.events.kNavigation+"."+(e.viewport||b.context),b)}))):f.attr("data-nav")?(e=f.attr("data-nav-options"),e=X.utils.jsonSerializer.toJSON(e,!0)||{},f.prop("nav-options",e),f.prop("eventList").push(c(function(a){var b=f.prop("nav-options");b=X.resolveDynamicData(b),b.nav=X.resolveDynamicData(f.attr("data-nav")),d(b),a.preventDefault(),X.publish(X.constants.events.kNavigation+"."+(e.viewport||b.context),b)}))):f.attr("data-jump")?(e=f.attr("data-jump-options"),e=X.utils.jsonSerializer.toJSON(e,!0)||{},f.prop("jump-options",e),f.prop("eventList").push(c(function(a){var b=f.prop("jump-options");b=X.resolveDynamicData(b),b.jump=X.resolveDynamicData(f.attr("data-jump")),d(b),a.preventDefault(),X.publish(X.constants.events.kNavigation+"."+(e.viewport||b.context),b)}))):f.attr("data-href")&&f.prop("eventList").push(c(function(a){var b=X.resolveDynamicData(f.attr("data-href")),c=X.getComponent(X.constants.interfaces.kViewResolver);document.location.href=c.resolveHref(b)}))}}),X._.extend(X.registry,{registerUIComponentClass:function(a,b,c){var d=new b;if("uiComponent"!==d.interfaceType)throw new X.Exception("X.registry","Register: component must implement a UI interface: ",X.log.ERROR);d=null,this._register(X.constants.registry.kUIComponents,a,b,c),X.trace("added UI component, name = "+a)},createUIComponent:function(a){var b=this._get(X.constants.registry.kUIComponents,a);return b?new b:(X.publishException("X.registry","createComponent: component: '"+a+"' does not exist"),null)}}),X.utils.parseRepeatAttr=function(a){var b=a.attr("data-repeat");b=b.trim();var c={};X.resolveDynamicData(b,c);var d=b.split(/\s+/);if(!d||d.length<3||!X._.contains(["in","inModelGroup"],d[1]))return X.publishException("X.utils.parseRepeatAttr","Invalid data-repeat: "+b),null;var e=X.utils.evaluateSimpleOperand(d.splice(2).join(" "));return"inModelGroup"===d[1]?e=X.getModelGroup(e,!0):e&&"string"==typeof e&&(e=X.utils.stringToFunction(e)),{key:d[0],collection:e,stamp:X.utils.htmlUnescape(a.html()),bindings:c}},X.utils.renderRepeater=function(a,b,c){function d(){if(!b.collection)return void X.trace("Repeater collection is empty, no data rendered. Repeater Element: "+X.utils.htmlEscape(a[0].outerHTML),X.log.INFO);if(!b.collection||!b.key||!b.stamp){var d=b.collection?b.key?"stamp":"key":"collection";return d="Invalid "+d,X.publishException("X.utils.repeaterFunc","Invalid arguments passed to repeater: "+d+" Repeater Element: "+a[0].outerHTML),""}var f=-1,g=!1,h=!1,i=!1,j=X._.size(b.collection),k="";return X._.each(b.collection,function(a,d){f++,g=0===f,h=f===b.collection.length-1,i=!g&&!h;var l=X._.extend({_count:j,_index:f,_key:d,_first:g,_last:h,_middle:i},c);l[b.key]=a instanceof X.data.Model?a.getAll():a,k+=e(b.stamp,l)}),k}function e(a,b){a=a.replace(/\$\{([^\s]*)\}/g,function(){return"X_MODEL("+arguments[1]+")"});var c=X._.keys(b).join("|");return a=a.replace(X.constants.expressionRegexPattern,function(){var a=new RegExp("("+c+")"),d=arguments[1].match(a);if(d){var e=arguments[0].replace(/X_MODEL\((.*?)\)/g,function(){return"${"+arguments[1]+"}"});return X.resolveDynamicData(e,{},b)}return arguments[0]}),a=a.replace(/X_MODEL\((.*?)\)/g,function(){return"${"+arguments[1]+"}"})}c=c||{};var f=X.$("<div></div>");f.html(d()),a.empty().append(f.contents())},X.data={binder:{}},X._.extend(X,{attach:function(a,b){a=X.utils.get$(a),a.length||(a=X.$("body")),b=b||{},X.data.binder.bindText(a,b),X.data.binder.bindAttributes(a,b),X.data.binder.bindData(a,b)},detach:function(a){a=X.utils.get$(a),a.unbind()},addModel:function(a,b){b=b||{};var c,d;if(!a)return X.publishException("DATA API","addModel requires a valid name",X.log.WARN),null;if(a instanceof X.data.Model)return X.registry.registerModel(a,!0);if(X._.isPlainObject(a)&&a.modelName&&(b=a,a=a.modelName),!a.match(X.constants.modelNameRegex))return X.publishException("DATA API","invalid model name: '"+a+"'",X.log.WARN),null;var e=X.getModel(a);if(e)return X.trace("addModel: Model '"+a+"' already exists. Not adding model."),e;b.schema&&(b.schema instanceof X.data.Schema?d=b.schema:X._.isPlainObject(b.schema)?d=new X.data.Schema(b.schema):X._.isString(b.schema)&&(d=X.registry.getSchema(b.schema)));var f=b.className||X.options.defaultModelClass||"X.data.Model",g=X.utils.stringToFunction(f);return c=new g({modelName:a,daoName:b.daoName,schema:d,groupId:b.groupId,allowInvalidDataInModel:b.allowInvalidDataInModel}),X.registry.registerModel(c,!0),c},addModels:function(a){var b=[];return X._.each(a,function(a,c){X._.isString(a)&&(c=a,a={}),b.push(X.addModel(c,a))}),b},removeModel:function(a,b){return b=b||{},b.modelNames=[a],X.clearData(b).then(function(){var b=X.getModel(a);b&&b.destroy(),X.registry.removeModel(a)})},getModel:function(a,b){if(!a||!a.match(X.constants.modelNameRegex))return void X.publishException("DATA API","Model name: '"+a+"' is invalid, cannot contain spaces, single or double quotes");var c=X.registry.getModel(a);return!c&&b&&(c=X.addModel(a)),c},getModels:function(a,b,c){return X.registry.getModels(a,b,c)},getModelGroup:function(a,b){return X.registry.getModels({groupId:a},null,b)},addModelToGroups:function(a,b){var c=X.getModel(a);c?c.addToGroups(b):X.trace("Data API","addModelToGroups : model: "+a+" does not exist",X.log.WARN)},loadSchema:function(a,b,c){var d=X.$.Deferred(),e=X.registry.getSchema(a);return e&&c?d.resolve(e):X._.isPlainObject(b)?(e=new X.data.Schema(b),X.registry.registerSchema(a,e,c),d.resolve(e)):X.loaders.JSONLoader.load(b).then(function(b){e=new X.data.Schema(b),X.registry.registerSchema(a,e,c),d.resolve(e)},function(a){X.publishException("Data API","Failed to load schema: "+b,X.log.ERROR,a),d.reject(a)}),d.promise()},loadSchemas:function(a,b){var c=[];return X._.each(a,function(a,d){c.push(X.loadSchema(d,a,b))}),X.$.when.apply(X.$,c)},registerDAO:function(a,b,c){X.registry.registerDAO(a,b,c)},getDAO:function(a){return X.registry.getDAO(a)},setDataVal:function(a,b,c,d){var e=X.getModel(a,X.options.autoCreateModels);e?e.setDataVal(b,c,d):X.publishException("DATA API","setDataVal: Model does not exist: "+a,X.log.WARN)},getDataVal:function(a,b){var c;if(void 0!==b){if(c=X.getModel(a,X.options.autoCreateModels))return c.getDataVal(b);X.publishException("DATA API","getDataVal: Model does not exist: "+a,X.log.WARN)}},unsetDataVal:function(a,b,c){var d=X.getModel(a);d&&d.remove(b,c)},getAllDataInModel:function(a,b){var c=X.getModel(a);return c?c.getAll(b):(X.publishException("DATA API","getAllDataInModel: Model does not exist: "+a,X.log.WARN),null)},saveData:function(a){return"string"==typeof a&&(a={modelNames:[a]}),X.data.DAOFacade.save(a)},loadData:function(a){return"string"==typeof a&&(a={modelNames:[a]}),X.data.DAOFacade.load(a)},clearData:function(a){return"string"==typeof a&&(a={modelNames:[a]}),X.registry.clear(a.modelNames,a),a.includePersistedData?X.data.DAOFacade.destroy(a):X.$.Deferred().resolve().promise()},addChangeListener:function(a,b,c){var d=a.indexOf(".")>0?X.utils.splitDataRef(a):{modelName:a,key:null,isCollection:!1},e=X.getModel(d.modelName),f=X.constants.events.kDataChange;e&&(e.off(f+"."+a,b,c),e.on(f+"."+a,b,c))},removeChangeListener:function(a,b,c){var d=a.indexOf(".")>0?X.utils.splitDataRef(a):{modelName:a,key:null,isCollection:!1},e=X.getModel(d.modelName);e&&e.off(X.constants.events.kDataChange+"."+a,b,c)}}),X.constants=X.utils.mergeObjects(X.constants,{specialDOMAttributes:["data-visible","data-disabled","data-hidden"],booleanDOMAttributes:["checked","compact","declare","defer","ismap","multiple","nohref","noresize","noshade","nowrap","readonly","selected"],events:{kDataChange:"dataChange",kModelCreated:"modelCreated",kModelDeleted:"modelDeleted",kModelRegistered:"modelRegistered"},interfaces:{kDAO:"DAO"},registry:{kDAOs:"daos",kModels:"models",kSchemas:"schemas",kGroups:"groups"},modelNameRegex:/(^[^\s\r\n\'\"\.\,]+)$/}),X.constants.allDirectives=X.constants.allDirectives||["data-bind","data-listen","data-bind-options","data-listen-options"],X._.extend(X.options,{dataBindEvent:["blur"],defaultTextForNullModelValue:"",dontBindTextInNodeList:["script","code"],autoCreateModels:!0,defaultModelClass:"X.data.Model",attributeConversionList:["data-class","data-style","data-value","data-src","data-href"],visibilityFunction:null,disabledFunction:null}),X.data.Model=X.Class.extend({construct:function(a){var b=this;if(!a.modelName)throw new X.Exception("X.model","Constructor : 'modelName' parameter is required to create a model",X.log.ERROR);if(!a.modelName.match(X.constants.modelNameRegex))throw new X.Exception("X.model","Constructor : 'modelName' is invalid, cannot contain spaces, single or double quotes",X.log.ERROR);this._id=X.utils.uuid(),this._name=a.modelName,this._dao=a.daoName,this._model={},this._nestedModels={},this._attributes={},this._groups=[],this._schema=new X.data.Schema,this._mutable=!0,this._allowInvalidData=X._.isBoolean(a.allowInvalidDataInModel)?a.allowInvalidDataInModel:!0,this._changedData=[],this._errorList=[],X._.extend(this,X.events.Events),a.groupId&&b.addToGroups(a.groupId),a.schema&&(a.schema instanceof X.data.Schema?b.setSchema(a.schema):X._.isObject(a.schema)&&b.setSchema(new X.data.Schema(a.schema))),b.init(),X.publish(X.constants.events.kModelCreated,{name:b._name,id:b._id,def:b._schema,groups:b._groups})},init:function(){},destroy:function(){var a=this;X._.each(this._nestedModels,function(a){a&&(a.destroy(),X.removeModel(a.getName()))}),X.publish(X.constants.events.kModelDeleted,{name:a._name,id:a._id,def:a._schema,groups:a._groups})},getName:function(){return this._name},addToGroups:function(a){a&&(X._.isString(a)&&(a=[a]),this._groups=X._.union(this._groups,a))},getGroupIds:function(){return this._groups},setSchema:function(a){var b=this;return a instanceof X.data.Schema?(b._schema=a,b._mutable=b._schema.mutable(),b._schema.groupId()&&b.addToGroups(b._schema.groupId()),void X._.each(this._schema.getAll(),function(a,c){X._.has(a,"defaultValue")&&b.setDataVal(c,X.resolveDynamicData(a.defaultValue))})):void X.publishException("X.DataModel: "+this._name,"Trying to set a schema that is not a X.data.Schema",X.log.ERROR)},getSchema:function(){return this._schema},getSchemaforKey:function(a){if(a){for(var b=a.split("."),c=b.shift();b.length>0;){if(this._nestedModels[c])return this._nestedModels[c].getSchemaforKey(b.join("."));c=b.shift()}return this._schema.defForKey(c)}},setAttribute:function(a,b){this._attributes[a]=b},getAttribute:function(a){return this._attributes[a]},isDirty:function(){return!X._.isEmpty(this._changedData)},clearDirty:function(){this._changedData=[]},setDataVal:function(a,b,c){function d(b,d,e){if(!c.silent){var f={$el:c.$el,def:h.getSchemaforKey(a),groupId:h._groupId,modelName:h._name,key:b,val:d,oldval:e,id:h._id};f[h._name+"."+b]=d,X.publish(X.constants.events.kDataChange+"."+f.modelName+"."+f.key,f)}}c=c||{};var e,f,g,h=this,i=null;if(f=this._isArray(a),a=X.utils.normalizeModelRef(a),e=a.match(/^(.*)\.(.*)$/),!this._mutable){var j=X.utils.normalizeModelRef(a,!0).match(/^(.*?)\.(.*)$/);if(j=j?j[1]:a,!this._schema.hasKey(j))return void X.publishException("Model: "+this._name+" is not mutable.  Cannot add '"+a+"' to the definition","X.data.Model",X.log.WARN)}var k={silent:!1,force:!1,trim:!1};c=X._.extend(k,c),X._.isString(b)&&c.trim&&(b=b.trim());var l=this.getSchemaforKey(e?e[1]:a);if(l&&l.readOnly&&!c.force)return void X.trace("Not setting read-only property'"+a+"' of "+this._name,"X.data.Model",X.log.WARN);var m=c.force?!1:l&&l.type;if(m){i=l.type,i.name&&(i=i.name),X._.isArray(i)&&(i="Array"),X._.isObject(i)&&(i="Object");var n="";switch(i.toLowerCase()){case"int":case"integer":case"number":if(!X._.isNumber(b)){try{X._.isString(b)&&(b=b.replace(/[^0-9.]/g,""),b=b.indexOf(".")>=0?parseFloat(b):parseInt(b,10))}catch(o){b=null}("number"!=typeof value||isNaN(b))&&(n="Cannot set '"+a+"' to value '"+b+"' - not a valid number")}break;case"bool":case"boolean":if(!X._.isBoolean(b)){try{null===b?b=!1:X._.isString(b)&&("true"==b||"1"==b?b=!0:("false"==b||"0"==b)&&(b=!1))}catch(o){b=null}X._.isBoolean(b)||(n="Cannot set '"+a+"' to value '"+b+"' - not a boolean")}break;case"string":X._.isString(b)||(n="Cannot set '"+a+"' to value '"+b+"' - not a valid string");break;case"function":if(X._.isString(b)&&(b=X.utils.stringToFunction(b)),!X._.isFunction(b))return void(n="Cannot set '"+a+"' to value '"+b+"' - not a valid function");break;case"model":var p=a.match(/^(.*?)\.(.*)$/),q=p?p[1]:a;if(this._nestedModels[q]||(b instanceof X.data.Model?this._nestedModels[q]=b:this._nestedModels[q]=new X.data.Model({modelName:this._name+"~"+q,schema:l.metaData})),p)this._nestedModels[q].setDataVal(p[2],b,c);else if(b instanceof X.data.Model);else{if(!X._.isObject(b))return void X.publishException("X.DataModel: "+this._name,"Trying to set a model with a value that is not an n/v pair - ignoring",X.log.WARN);this._nestedModels[q].update(b,c)}return this._model[q]=this._nestedModels[q].getAll(),this._setChanged(q),void d(q,this._model[q]);case"array":X._.isArray(b)||X._isArray(a)||(n="Model: "+this._name+".  Cannot set '"+a+"' to value '"+b+"' - not an array");break;case"object":X._.isPlainObject(b)||(n="Model: "+this._name+".  Cannot set '"+a+"' to value '"+b+"' - not an object")}if(n)return void X.publishException("X.DataModel: "+this._name,"errMsg",X.log.WARN)}if(this._allowInvalidData||""===b||this.validateElement(a,b))if(f)g=this._findOrCreateCollection(this._model,f[1],!0),g[f[2]]=b,this._setChanged(a),d(f[1]+"."+f[2],b);else if(e)g=this._findOrCreateCollection(this._model,e[1]),f=this._isArray(e[2]),f?(g[f[1]]=g[f[1]]||[],g[f[1]][f[2]]=b):g[e[2]]=b,this._setChanged(a),d(a,b);else if(b instanceof X.data.Model)r=this._model[a],this._nestedModels[a]=b,this._setChanged(a),this._model[a]=this._nestedModels[a].getAll(),d(a,this._model[a],r);else{var r=this._model[a];X._.isEqual(this._model[a],b)||(this._setChanged(a),this._model[a]=b),d(a,b,r)}},getDataVal:function(a){return X.utils.stringToFunction(X.utils.normalizeModelRef(a,!0),this._model)},remove:function(a,b){if(b&&!b.silent){var c;this.setDataVal(a,c,{force:!0})}var d=this._model;a=X.utils.normalizeModelRef(a);var e=a.match(/^(.*)\.(.*)$/);e&&(d=X.utils.stringToFunction(X.utils.normalizeModelRef(e[1],!0),this._model),a=e[2]);var f=this._isArray(a);f?d[f[1]]=X._.without(d[f[1]],d[f[1]][f[2]]):(delete d[a],this._nestedModels[a]&&delete this._nestedModels[a])},update:function(a,b){var c=this;return null===a||void 0===a?void X.publishException("Trying to update model '"+this._name+"' with a null/undefined object","X.data.Model",X.log.ERROR):void(X._.isObject(a)?X._.each(a,function(a,d){c.setDataVal(d,a,b)}):X.publishException("X.DataModel: "+this._name,"Update invalid object passed in - ignoring"))},getAll:function(a){a=a||{};var b=this._model;return a.changedDataOnly&&(b=X._.pick(b,this._changedData)),a.excludeErrors&&(this.validate(),b=X._.omit(b,this._errorList)),b},has:function(a){return!X._.isUndefined(this._model[a])},each:function(a){return X._.each(this._model,a)},clear:function(a){var b=this;X._.each(this._model,function(c,d){b.remove(d,a)}),this.clearDirty()},validateElement:function(a,b){var c=this._schema.getOptionForKey(a,"validate");if(c){X._.isArray(c)&&(c=c.join()),b=b||(X._.isUndefined(this._model[a])?"":this._model[a]);var d=X.$("<input value='"+b+"' data-validate='"+c+"' />"),e=X.validateElement(d,{suppressErrors:!0});return e||this._errorList.push(a),e}return!0},validate:function(){var a=this;return a._errorList=[],X._.each(a._schema.keys(),function(b){a.validateElement(b)}),a._errorList},getErrorList:function(){return this.validate(),this._errorList},hasError:function(){return this.validate(),X._.size(this._errorList)>0},save:function(a){a=a||{};var b=this._getDAO(a.daoName);return b?b.save([this],X._.omit(a,["daoName"])):X.$.Deferred().resolve().promise()},load:function(a){a=a||{};var b=this._getDAO(a.daoName);return b?b.load([this],X._.omit(a,["daoName"])):X.$.Deferred().resolve().promise()},_getDAO:function(a){var b=a||this._dao;return b=X.registry.getDAO(b),b?b:(X.trace("Model DAO: "+this._name+"called with no DAO"),null)},_findOrCreateCollection:function(a,b,c){var d,e=this._isArray(b),f=b.match(/^(.*?)\.(.*)$/);return f?(f[1]&&(e=this._isArray(f[1]),e?(a[e[1]]=a[e[1]]||[],a[e[1]][e[2]]=a[e[1]][e[2]]||{},d=a[e[1]][e[2]]):(a[f[1]]=a[f[1]]||{},d=a[f[1]])),this._findOrCreateCollection(d,f[2],c)):e?(a[e[1]]=a[e[1]]||[],a[e[1]][e[2]]=a[e[1]][e[2]]||(c?[]:{}),a[e[1]][e[2]]):(a[b]=a[b]||(c?[]:{}),a[b])},_isArray:function(a){return a.toString().match(/^(.*)\[(\d*?)\]$/)},_setChanged:function(a){this._changedData=X._.union(this._changedData,[a])}}),X.utils.attributeUtil=function(){function a(a,b,d,e){var f=X.utils.get$(a);if(X._.contains(c,b)&&(b=b.replace(/^data-/,"")),X._.contains(X.constants.booleanDOMAttributes,b)){var g=d&&"false"!==d&&"undefined"!==d&&"null"!==d;return void(g?f.prop(b,!0):f.prop(b,!1))}switch(b){case"disabled":var h=d&&"false"!==d&&"undefined"!==d&&"null"!==d,i=f.attr("data-disabled-options");i=X.utils.jsonSerializer.toJSON(i,!0)||{};var j=i.disabledFunction||X.options.disabledFunction;if(j){if("string"==typeof j&&(j=X.utils.stringToFunction(j)),"function"==typeof j)return void j(f,h);X.publishException("resolveAttributes: disabled","disabled function does not exist - using default: ",X.log.WARN)}h?(f.prop("disabled",!0),f.addClass("disabled")):(f.prop("disabled",!1),f.removeClass("disabled"));break;case"visible":case"hidden":var k=!(!d||"false"===d||"undefined"===d||"null"===d);k="visible"==b?k:!k;var l=f.attr("data-visible-options")||f.attr("data-hidden-options");l=X.utils.jsonSerializer.toJSON(l,!0)||{};var m=l.visibilityFunction||X.options.visibilityFunction;if(m){if("string"==typeof m&&(m=X.utils.stringToFunction(m)),"function"==typeof m)return void m(f,k);X.publishException("resolveAttributes: visible","visiblilty function does not exist - using default: ",X.log.WARN)}var n=X.$(f).prop("x_isVisible");if(k){if("true"==n)return;X.$(f).parent().is(":hidden")||e?f.show():f.fadeToggle(300),X.$(f).prop("x_isVisible","true")}else{if("false"==n)return;X.$(f).parent().is(":hidden")||e?f.hide():(X.removeErrorTips&&X.removeErrorTips(f),f.fadeToggle(300)),X.$(f).prop("x_isVisible","false")}break;default:f.attr(b,d)}}function b(){c=X._.map(X.constants.booleanDOMAttributes,function(a){return"data-"+a}),c=X._.union(c,X.constants.specialDOMAttributes),c=X._.union(c,X.options.attributeConversionList)}var c,d={toJSON:function(a){if("string"!=typeof a||!a)return{};var b=null,c=a.trim();return"{"!==c.charAt(0)&&(c="{"+c+"}"),b=X.utils.jsonSerializer.toJSON(c,!0),b||{}},attrChangeHandler:function(){var b=arguments[arguments.length-1];if(!b||!b.el)return void X.trace("attrChangeHandler error: bad param ",["X.bindings",""],X.log.ERROR);var c=X.utils.get$(b.el),d=b.attributesToResolve||c.prop("attributesToResolve");d&&X._.each(d,function(b,d){var e=X.resolveDynamicData(b.attrValue,{});a(c,b.attrName,e,!1)})},resolveAttributes:function(b){var c=X.utils.get$(b),d=c.prop("attributesToResolve");if(d){var e={};X._.each(d,function(c){var d={},f=X.resolveDynamicData(c.attrValue,d);a(b,c.attrName,f,!0),X._.size(d)>0&&X._.each(d,function(a,b){e[X.constants.events.kDataChange+"."+b]||(e[X.constants.events.kDataChange+"."+b]=[]),e[X.constants.events.kDataChange+"."+b].push(c)})}),X._.each(e,function(a,c){X.subscribe(c,X.utils.attributeUtil.attrChangeHandler,b,{el:b,attributesToResolve:a})})}}};return b(),X.subscribe(X.constants.events.kOptions+".attributeConversionList",b,d),d}(),X.data.binder={bindText:function(a){var b=X.utils.get$(a);b.find("*").bindText()},bindData:function(a,b){var c=X.utils.get$(a);X.$("[data-bind]",c).each(function(){var a=X.$(this),c=null,d=a.attr("data-bind"),e={},f=X.resolveDynamicData(d,e);X._.size(e)>0&&a.prop("unresolvedDataBind",d),a.attr("data-bind",f);var g=X.utils.splitDataRef(f),h=X.getModel(g.modelName,X.options.autoCreateModels);h&&(c=h.getSchemaforKey(g.key));var i=a.is("input")||a.is("select")||a.is("textarea");if(c&&i){var j=a.attr("data-validate"),k=a.attr("data-format"),l=a.attr("placeholder");c.validate&&!j&&a.attr("data-validate",c.validate.toString()),c.format&&!k&&a.attr("data-format",c.format),c.placeholderText&&!l&&a.attr("placeholder",c.placeholderText),c.accessibility&&a.attr("aria-label",c.accessibility)}a.bindToModel(b)})},bindAttributes:function(a,b){var c=X.utils.get$(a);X.$("*",c).each(function(a,b){if(!X.$(b).prop("attributesToResolve")){var c=[];X._.each(b.attributes,function(a){!X._.contains(X.constants.allDirectives,a.nodeName)&&(a.nodeValue.indexOf("${")>=0||a.nodeValue.indexOf("@{")>=0)&&c.push({el:b,attrName:a.nodeName,attrValue:a.nodeValue})}),c.length>0&&(X.$(b).prop("attributesToResolve",c),X.utils.attributeUtil.resolveAttributes(b));var d=X.$(b).attr("data-listen");d&&(d=d.match(/([\.\w]+)/g).join(","),X.subscribe(d,X.utils.attributeUtil.attrChangeHandler,b,{el:b}))}})}},X.components.DataResolver=function(){function a(a,d,e){e._x_refs=e._x_refs||[];var f,g,h;if(!X._.isObject(a)&&!X._.isString(a))return a;if(X._.isObject(a))return a=X.utils.jsonSerializer.toString(a),a=c.resolveDynamicData(a,d,e),X.utils.jsonSerializer.toJSON(a);var i=a.lastIndexOf("@{"),j=a.lastIndexOf("${");if(f=i>j?i:j,g=a.indexOf("}",f),0>f||0>g)return a;if(h=a.substring(f,g+1),f===i)return a=a.replace(/(["'])(\s*)?(_x_refs\[(\d)\])(\s*?)?\1/g,function(){var a=X.utils.jsonSerializer.toString(e._x_refs[arguments[4]]),b=arguments[0].replace(arguments[3],a);return b}),a=a.replace(h,b(h,e)),c.resolveDynamicData(a,d,e);var k,l=a.substring(f+2,g);l=l.replace(/_x_refs\[(\d)\]/g,function(){return e._x_refs[arguments[1]]});var m=X.utils.splitDataRef(l),n=X.getModel(m.modelName,X.options.autoCreateModels);return n&&m.key?k=n.getDataVal(m.key):n&&(k=n.getAll()),d&&m.modelName&&!X._.isUndefined(m.key)&&(d[m.modelName+"."+m.key]=k),("undefined"==typeof k||null===k)&&(k=X.options.defaultTextForNullModelValue),a=a.replace(h,"_x_refs["+e._x_refs.length+"]"),e._x_refs.push(k),c.resolveDynamicData(a,d,e)}function b(a,b){b=b||{};var g,h=a;h=h.replace(X.constants.expressionRegexPattern,function(){return"<%="+arguments[1]+"%>"});try{d[h]?g=d[h]:(g=X._.template(h),d[h]=g)}catch(i){X.publishException("resolveAttribute","Invalid expression: "+a+" ("+i.message+")",X.log.ERROR,i),h=""}try{var j=c.resolveDynamicData(b);Object.prototype.toString=function(){return X.utils.jsonSerializer.toString(this)},Array.prototype.toString=function(){return X.utils.jsonSerializer.toString(this)},h=g(j),Object.prototype.toString=e,Array.prototype.toString=f}catch(i){X.publishException("resolveExession","Expression error for "+a+" : "+i.message,X.log.ERROR,i),h=""}return h}var c={resolveDynamicData:function(b,d,e){e=e||{},d=d||{};var f,g=e;if(!X._.isObject(b)&&!X._.isString(b))return b;if(X._.isObject(b))return b=X.utils.jsonSerializer.toString(b),b=c.resolveDynamicData(b,d,g),X.utils.jsonSerializer.toJSON(b);f=a(b,d,g),f=f.replace(/_x_refs\[(\d)\]/g,function(){var a=e._x_refs[arguments[1]];return X.utils.jsonSerializer.toString(a)});try{f=decodeURIComponent(f)}catch(h){}return f}},d=[],e=Object.prototype.toString,f=Array.prototype.toString;return c},X.registerComponent(X.constants.interfaces.kDataResolver,new X.components.DataResolver,!1),X.data.DAOFacade=function(){function a(a,b){a=a||{};var c=[],d=0,e=a.modelNames,f={};return"string"==typeof e&&(e=[e]),a.daoName?f[a.daoName]=X.registry.getDAO(a.daoName):f=X.registry.getDAOs(),f&&0<X._.keys(f).length&&X._.each(f,function(f,g){var h=X.utils.getModelsForDAO(g,e,a.modelFilters);h&&h.length>0&&(c[d++]=f[b](h,X._.omit(a,["modelNames","daoName","modelFilters"])))}),X.$.when.apply(X.$,c)}var b={save:function(b){return a(b,"save")},load:function(b){return a(b,"load")},destroy:function(b){return a(b,"destroy")}};return b}(),X.utils.extend_$({bindToModel:function(a){function b(a,b){if(X._.isUndefined(b)?b=null:X._.isNull(b)||(b=b.toString()),"checkbox"==a.attr("type")){var c=b&&"false"!==b;c?a.attr("checked","checked"):a.removeAttr("checked")}else if("radio"==a.attr("type")){var d=a.val();b===d?a.attr("checked","checked"):a.removeAttr("checked")}else a.is("input")||a.is("select")||a.is("textarea")?a.val(b):a.text(b)}function c(a,b,c){var d=X.utils.splitDataRef(a);X.setDataVal(d.modelName,d.key,b,c)}function d(a,d,g){if(g){var h=g.bindFunction;if(h){var i=X.utils.stringToFunction(h);i?i(d,a):X.publishException("DataBinder","Bind function not defined: "+h,X.log.WARN)}if(!X._.isUndefined(g.defaultValue)){var j=null,k=X.utils.splitDataRef(f);if(j=X.getDataVal(k.modelName,k.key),void 0===j){var l=X.resolveDynamicData(g.defaultValue);b(e,l,g),c(f,l,g)}}}}a=a||{};var e=X.$(this),f=e.attr("data-bind"),g=X.utils.attributeUtil.toJSON(e.attr("data-bind-options"),!0)||{};if(g.$el=e,g.viewport=a.viewport,f){var h=X.utils.splitDataRef(f),i=X.getDataVal(h.modelName,h.key),j=X.constants.events.kDataChange+"."+h.modelName+"."+h.key;b(e,i,g),d(e,i,g);var k=g.dataBindEvent?g.dataBindEvent:X.options.dataBindEvent;k=X._.isArray(k)?k.join(" "):k,e.isTextInput()||(e.is("select")||e.is("input")?k+=" change":"true"==e.attr("contentEditable")&&(k+=" input")),e[0].dataChangeHandler=e[0].dataChangeHandler||function(a){var b=null;b="checkbox"==e.attr("type")?e.prop("checked"):e.is("select")?e.find(":selected").val():"true"==e.attr("contentEditable")?e.text():e.val(),c(f,b,g)},e.off(k,e[0].dataChangeHandler).on(k,e[0].dataChangeHandler),e[0].databindListener=e[0].databindListener||function(a){if(a.$el!==e){var c=X._.isUndefined(a.index)?a.val:a.val[a.index];b(e,c,g),d(e,c,g)}},X.subscribe(j,e[0].databindListener,e[0])}}}),X.utils.extend_$({bindText:function(){function a(a,b,c){var d=[];if(X._.each(b,function(a,b){d.push(X.constants.events.kDataChange+"."+b)}),d.length>0){var e=d.join(",");X.subscribe(e,function(a,b){b&&b.el?b.el.nodeValue=X.resolveDynamicData(b.origVal):a&&a.el&&(a.el.nodeValue=X.resolveDynamicData(a.origVal))},a,{el:a,origVal:c})}}return this.each(function(){var b,c,d=this.firstChild;if(d)do{var e=d.parentNode.tagName.toLowerCase();if(3===d.nodeType&&!X._.contains(X.options.dontBindTextInNodeList,e)){b=d.nodeValue;var f={};c=X.resolveDynamicData(b,f),c!==b&&(a(d,f,b),d.nodeValue=c)}}while(d=d.nextSibling)})}}),X.data.ABTestModel=X.data.Model.extend({construct:function(a){this._name="ABTest",this._id=X.utils.uuid(),this._model=a,this._attributes={},this._groups=[],this._mutable=!0,this._schema=new X.data.Schema,this._allowInvalidData=!0,this._changedData={},this._errorList={},X._.extend(this,X.events.Events)}}),X._.extend(X.registry,{registerModel:function(a,b){a instanceof X.data.Model||X.publishException("Data Registry","Model  must extend from X.data.DataModel"),this._register(X.constants.registry.kModels,a.getName(),a,b),X.publish(X.constants.events.kModelRegistered,a.getName())},getModel:function(a){return X.flow&&a===X.constants.scopes.kFlowScope&&(a=X.application.Controller.getCurrentFlowScopeName()),this._get(X.constants.registry.kModels,a)},getModels:function(a,b,c){var d=this;a=a||{};var e=b||this._getAll(X.constants.registry.kModels),f=[];return X._.each(e,function(b,e){if("string"==typeof b&&(b=d.getModel(b)),!b)return!0;var g=!1;a.isDirty&&b.isDirty()&&(g=!0),a.daoName&&b._dao==a.daoName&&(g=!0),a.noErrors&&(g=!b.hasError()),a.groupId&&(g=X._.contains(b.getGroupIds(),a.groupId)),a.attr&&(g=b.getAttribute(a.attr)),a.fn&&X._.isFunction(a.fn)&&(g=a.fn(b)),0===X._.size(a)&&(g=!0),g&&(c?f.push(b):f.push(b.getName()))}),f},removeModel:function(a){var b=this._get(X.constants.registry.kModels,a);b&&this._remove(X.constants.registry.kModels,a)},clear:function(a,b){var c=this;a=a||X._.keys(this._getAll(X.constants.registry.kModels)),"string"==typeof a&&(a=[a]),X._.each(a,function(a,d){a&&c._has(X.constants.registry.kModels,a)&&c.getModel(a).clear(b)})},registerDAO:function(a,b,c){return b._name=a,this._register(X.constants.registry.kDAOs,a,b,c)},getDAO:function(a){return this._get(X.constants.registry.kDAOs,a)},getDAOs:function(){return this._getAll(X.constants.registry.kDAOs)},registerSchema:function(a,b,c){return b instanceof X.data.Schema||X.publishException("Data Registry","Model Def: "+a+" must be a X.data.Schema"),this._register(X.constants.registry.kSchemas,a,b,c)},getSchema:function(a){return this._get(X.constants.registry.kSchemas,a)},getSchemas:function(){return this._getAll(X.constants.registry.kSchemas)}}),X.data.Schema=X.Class.extend({construct:function(a){this._def=a||{},this._def=X._.omit(this._def,"metaData"),this._metaData=a?a.metaData:null,this._mutable=a?a.metaData?a.metaData.mutable:!1:!0,this._groupId=a&&a.metaData?a.metaData.groupId:null},hasDefinition:function(){return this.keys().length>0},mutable:function(){return this._mutable},groupId:function(){return this._groupId},hasMetaData:function(){return null!==this._metaData},metaData:function(){return this._metaData||{}},hasKey:function(a){return X._.has(this._def,a)},defForKey:function(a){return this.hasKey(a)?this._def[a]:null},getAll:function(){return this._def},getOptionForKey:function(a,b){var c=this.defForKey(a);return c&&"undefined"!=typeof c[b]?c[b]:null},keys:function(){return X._.keys(this._def)}}),X._.extend(X.utils,{splitDataRef:function(a){var b={modelName:"",key:""};a=X.utils.normalizeModelRef(a,!0);var c=a.match(/^(.*?)\.(.*)$/);return c?(b.modelName=c[1],b.key=c[2]):b.modelName=a,b},normalizeModelRef:function(a,b){return a.replace(/(\[(.*?)\])/g,function(){return arguments[1].match(/[\'\"]/)||null===arguments[2].toNum()||b?"."+arguments[2].removeQuotes():arguments[0]})},getModelsForDAO:function(a,b,c){a._name&&(a=a._name);var d={daoName:a};return X._.extend(d,c),X.getModels(d,b,!0)},convertNamesToModels:function(a){var b=[];return X._.each(a,function(a,c){var d;X._.isString(a)?d=X.registry.getModel(a):a instanceof X.data.Model&&(d=a),d&&b.push(d)}),b}}),X.components.ActionExecutor=function(){var a={execute:function(a,b){function c(a,b,c){c=c||[],"object"!=typeof c&&(c=c.split(","));try{if(X._.isFunction(a)){var g=a.apply(b,c);g&&X._.isFunction(g.then)?g.then(function(a){e.resolve(a)},function(a){e.resolve(a)}):e.resolve(g)}else d=new X.Exception("ActionExecutor","Javascript action '"+f+"' does not exist. Check your function (case sensitive, or misnamed).",X.log.ERROR),X.publishException(d),e.reject(d)}catch(h){d=new X.Exception("ActionExecutor","Javascript action '"+f+"' threw an exception",X.log.ERROR,h),X.publishException(d),e.reject(d)}}var d,e=X.$.Deferred(),f=null,g=null,h=null;if(!a)return d=new X.Exception("X.components.actionExecutor","execute: no action passed in",X.log.ERROR),X.publishException(d),e.reject(d),e.promise();b&&!X._.isArray(b)&&(X.publishException("X.components.actionExecutor","execute: parameters not passed as array - ignoring them",X.log.WARN),b=null);var i=X.constants.functionRegex.exec(a);i&&(f=i[1],g=X.utils.getArrayOfArgs(i[3])),
0===g.length&&b&&X._.each(b,function(a,b){g.push(X.utils.evaluateSimpleOperand(a))});try{if(h=X.utils.stringToFunction(f)){var j=f.match(/(.*)\./);j=j?X.utils.stringToFunction(j[1]):window,c(h,j,g)}else d=new X.Exception("X.components.actionExecutor","Missing action "+f,X.log.ERROR),X.publishException(d),e.reject(d)}catch(k){d=new X.Exception("X.components.actionExecutor","Invalid action "+f,X.log.ERROR,k),X.publishException(d),e.reject(d)}return e.promise()}};return a},X.components.FlowResolver=function(){function a(){var a=X.options.flowResolverOptions;if(!a)throw new X.Exception("Flow Resolver","missing options",X.log.ERROR);if(a.cacheParam&&(c=a.cacheParam),"object"==typeof a.pathToFlows){b=a.pathToFlows;for(var e in b)for(var f;null!==(f=/\$\{(.*?)\}/g.exec(b[e]));){if(!b.hasOwnProperty(f[1]))throw new X.Exception("Flow Resolver",f[0]+" variable cannot be found.",X.log.ERROR);var g=b[f[1]];b[e]=b[e].replace(f[0],g)}if("string"!=typeof b["default"])throw new X.Exception("Flow Resolver","pathToFlows must contain a 'default' entry.",X.log.ERROR)}else{if("string"!=typeof a.pathToFlows)throw new X.Exception("Flow Resolver","pathToFlows is invalid.  Must be an object or string.",X.log.ERROR);b={"default":a.pathToFlows}}if("object"!=typeof a.aliasMap)throw new X.Exception("Flow Resolver","aliasMap is invalid.  Must be an object",X.log.ERROR);d=a.aliasMap}this.resolve=function(a){var e=X.$.Deferred(),f="default",g=X.getComponent(X.constants.interfaces.kABTestResolver),h=a,i=null,j=null,k=null,l=X.constants.nameSpaceRegex.exec(a);l?(f=l[1],h=l[2]):null!==a&&(f=a),i=b[f],i||(X.trace("Path alias '"+f+"' not found, using default path","Flow Resolver"),i=b["default"]),i.match(/\/$/)||(i+="/"),d[a]?(j=d[a],X.trace("ALIAS REF: '"+a+"' --> "+j,["FLOW RESOLVER"])):d[X.constants.kWildCard]&&(j=h+d[X.constants.kWildCard],X.trace("WILDCARD REF: '"+h+"' --> "+j,["FLOW RESOLVER"])),k=i+j;var m=g?g.getABTestFlow(a,k):null;m&&(X.trace(a+" --> "+m,["FLOW RESOLVER","ABTEST"]),k=m);var n="function"==typeof c?c():c;if("string"==typeof n){var o=k.indexOf("?")>=0?"&":"?";k+=o+n}if(j){var p=X.registry.getFlow(a);p?(X.trace("Loading flow out of memory: '"+j+"'",["FLOW RESOLVER"]),e.resolve(p)):X.loaders.JSONLoader.load(k).then(function(b){X.registry.registerFlow(a,b),X.trace("Loading flow off server: '"+a+"' --> "+k,["FLOW RESOLVER"]),e.resolve(b)},function(a){e.reject(a)})}else e.reject(new X.Exception("Flow Resolver","Flow Reference: "+a+" not found in config",X.log.ERROR));return e.promise()};var b,c,d;a(),X.subscribe(X.constants.events.kOptions+".flowResolverOptions",a,this)},X.$.ready(function(){X.registerComponent(X.constants.interfaces.kFlowResolver,new X.components.FlowResolver,!0)}),X.flow.ResourceLoader=function(){function a(a,b){X.publishException("ResourceLoader","Error Details: "+a,X.log.ERROR,b)}var b={loadResources:function(b){b&&X._.isObject(b)||a("loadJsAndCss requires a paramObject parameter. "),b=b||{};var c=b.javascript||b.js||[],d=b.css||[],e=b.schemas||b.schema||{},f=[];try{c&&X._.each(c,function(a,b){f.push(X.loaders.JSLoader.load(a))}),d&&X._.each(d,function(a,b){f.push(X.loaders.CssLoader.load(a))}),e.length&&X._.each(e,function(a){f.push(X.loadSchema(a))})}catch(g){a("Exception during loadResources: "+X.utils.jsonSerializer.toString(b),g)}return X.$.when.apply(X.$,f)}};return b}(),X.constants=X.utils.mergeObjects(X.constants,{events:{kFlowStart:"startFlow",kFlowTransition:"flowTransition",kFlowEnd:"endFlow",kFlowEndController:"endFlowController"},interfaces:{kActionExecutor:"actionExecutor",kFlowResolver:"flowResolver"},registry:{kFlows:"flows"}}),X.flow.constants={kViewState:"VIEW",kActionState:"ACTION",kFlowState:"FLOW",kEndState:"END",kErrorState:"ERROR",kWildCard:"*",kNavigationSeperator:"~"},X.flow.constants.historyType={kNever:"never",kSession:"session",kAlways:"always"},X._.extend(X.options,{flowResolverOptions:{pathToFlows:{"default":"flows"},aliasMap:{"*":".json"},cacheParam:null}}),X.flow.Flow=function(a,b){function c(a,b){var c=null,d=t?t.nodeName:"",e=null;if(b)c=a;else if(null===t||null===a){if(!m.has("startState"))return g("No 'startState' defined"),!1;d="startState",c=p.startState}else{if(!t.transitions)return g("Flow Object: "+n+" - No transitions defined for '"+t.nodeName+"'"),!1;e=t.transitions,c=e[a],!c&&e[X.flow.constants.kWildCard]&&(c=e[X.flow.constants.kWildCard])}if(!c)return a=a||"<EMPTY or NULL>",g("No Transition for: "+d+": "+a),!1;if(c=k(c),t=p[c],!t)return g(b?"Cannot jump, node does not exist: "+c:"No Transition for: "+d+" -answer: "+c),!1;t.nodeName=c,d?X.trace("Transition from state '"+d+"' response: '"+a+"' to state '"+t.nodeName+"'",["FLOW",n]):X.trace("Starting flow with state '"+t.nodeName+"'",["FLOW",n]);var f=t.modal||t.options&&t.options.modal?!0:!1;return X.publish(X.constants.events.kFlowTransition+"."+u,{name:n,id:o,nodeName:c,stateDef:t,metaData:r,modal:f}),!0}function d(a){if(!t)return g("JSFLow._run - No current state: "),void a();if(!t.state_type)return g("No 'state_type' defined for '"+t.nodeName+"'"),void a();var b=t.state_type;if(b==X.flow.constants.kViewState){var f=t.modal||(t.options?t.options.modal:!1);f||(v=t)}if(b==X.flow.constants.kViewState||b==X.flow.constants.kFlowState||b==X.flow.constants.kEndState)a();else if(b==X.flow.constants.kActionState){var i="_x_null",j=t,k=!1,m=t.showMessage;m&&(l(t),t.transitions.__action_show_message__="__ACTION_SHOW_MESSAGE__",c("__action_show_message__"),d(a),m.minTime&&(k=!0,setTimeout(function(){k=!1,"_x_null"!=i&&(c(i),y?(h(y.msg),a()):d(a))},m.minTime))),e(j,function(b){y?a():(i=""+b,k||(c(i),y?(h(y.msg),a()):d(a)))})}else g("Invalid State Type: "+b+" in "+t.name),a()}function e(a,b){var c=a.ref,d=a.exp;if(c){c=k(c);var e=new X.utils.Profiler("ACTION_PROFILE: "+c);e.mark("execute"),w.execute(c).then(function(a){e.captureTimeFromMark("executeTime","execute"),X.publish(X.constants.events.kProfile,e),X.trace(e.serialize()),b(a)},function(a){g(a),b()})}else{if(!d)return g("Invalid ACTION node - missing ref or exp");var f=k(d);X.trace("Executing expression '"+d+"' response: '"+f+"'",["FLOW",n]),b(f)}}function f(){return{name:n,metaData:r,options:q,id:o}}function g(a){y=new X.Exception("Flow","Flow Object: "+n+" - "+a,X.log.ERROR)}function h(a,b){var c=new X.Exception("Flow","Flow Object: "+n+" - "+a,X.log.ERROR);if(X.publishException(c),b)throw c}function i(){var a={};if(y)return a.state_type=X.flow.constants.kErrorState,a.error=y,a;switch(a.state_type=t.state_type,t.state_type){case X.flow.constants.kFlowState:case X.flow.constants.kViewState:a.value=t.ref,a.options=t.options,a.modal=t.modal,a.autoNav=t.autoNav,a.inputVars=j(t.inputVars),a.metaData=t.metaData;break;case X.flow.constants.kActionState:a.value=t.ref;break;case X.flow.constants.kEndState:t.outcome?a.value=k(t.outcome):(g("Node "+t.nodeName+" does not have an outcome"),a.error=y)}return"string"!=typeof a.value&&(a.value=""+a.value),a.outputVars=null,a.data=j(t.data),a.nodeName=t.nodeName,a}function j(a){var b={};return a&&X._.each(a,function(a,c){b[c]="string"==typeof a?k(a):a}),b}function k(a){return a=a.replace(X.constants.scopes.kFlowScope,m.getflowScopedModelName()),X.resolveDynamicData(a)}function l(a){var b=a.showMessage.message;b&&X.setDataVal(b.model,b.key,k(b.value)),p.__ACTION_SHOW_MESSAGE__={state_type:"VIEW",history:"never",transitions:a.transitions,ref:a.showMessage.ref,data:{messageNode:!0}}}var m={init:function(a,b,c,d){var e=this;q=b||{},u=q.context,r=p.metaData||{},X._.defaults(r,c),s=X.addModel(this.getflowScopedModelName()),a&&X._.each(a,function(a,b){X.setDataVal(e.getflowScopedModelName(),b,a)});var f=p.require||{};X.flow.ResourceLoader.loadResources(f).always(function(){f.models&&("string"==typeof f.models?X.addModel(f.models):X._.isObject(f.models)&&X.addModels(f.models)),d()})},start:function(a){if(x)return void X.trace("Cannot start flow: "+n+" We are busy");var b=this;y=null,X.publish(X.constants.events.kFlowStart+"."+u,f()),b.onStart(function(){b.doNext(null,function(b){a(b)})})},onStart:function(a){p.onStart?e(p.onStart,a):a()},end:function(a){var b=this;b.onEnd(function(){X.publish(X.constants.events.kFlowEnd+"."+u,f()),X.removeModel(b.getflowScopedModelName(),{silent:!0}),a()})},onEnd:function(a){p.onEnd?e(p.onEnd,a):a()},doNext:function(a,b){x&&(X.trace("Cannot doNext in flow: "+n+" We are busy"),b()),y=null,x=!0,c(a),d(function(){var a=i();x=!1,b&&b(a)})},jumpToState:function(a,b){if(x&&(X.trace("Cannot jump in flow: "+n+" We are busy"),b()),y=null,x=!0,this.allowRandomAccess()){if(c(a,!0),!t)return g("jumpToState: State Name '"+a+"' does not exist!"),null;t.name=a}d(function(){var a=i();x=!1,b&&b(a)})},restoreToLastView:function(a){if(t=v){var b=i();a(b)}else this.start(a)},has:function(a){return"undefined"!=typeof p[a]},allowRandomAccess:function(){return this.has("allowRandomAccess")?p.allowRandomAccess:!0},getName:function(){return n},getId:function(){return o},getNodeName:function(){return r.nodeName},getFlowVariable:function(a){return X.getDataVal(this.getflowScopedModelName(),a)},setFlowVariable:function(a,b){return X.setDataVal(this.getflowScopedModelName(),a,b)},getflowScopedModelName:function(){return o},isBusy:function(){return x}},n=a,o=X.constants.scopes.kFlowScope+"_"+X.utils.uuid(!0),p=b,q={},r={},s=null,t=null,u=null,v=null,w=X.getComponent(X.constants.interfaces.kActionExecutor),x=!1,y=null;return w||(w=X.registerComponent(X.constants.interfaces.kActionExecutor,new X.components.ActionExecutor)),a||h("Construtor: Flow name not specified",!0),b||h("Construtor: Flow Definition Object not specified",!0),m},X.flow.Controller=function(a){function b(a,c,d){if(a<c.length-1){var f=c[a];j.allowRandomAccess()||d(g("Cannot jump- flow does not allow jump access: "+j.getName())),j.has(f.nodeName)||d(g("Cannot jump- flow: "+j.getName()+" - does not have element: "+f.nodeName)),j.jumpToState(f.nodeName,function(g){e(g.value,f.inputVars,f.options,g.nodeName,function(e){e?d(e):j.onStart(function(){b(a+1,c,d)})})})}else d()}function c(a,b,c){b?j.jumpToState(a,function(a){d(a,c)}):a?j.doNext(a,function(a){d(a,c)}):j.start(function(a){d(a,c)})}function d(a,b){var d=a.modal||(a.options?a.options.modal:!1);if(d&&p)return h.pause(),void p(a);switch(a.state_type){case X.flow.constants.kViewState:b(a);break;case X.flow.constants.kFlowState:e(a.value,a.inputVars,a.options,a.nodeName,function(a){a?b(a):c(null,!1,function(a){b(a)})});break;case X.flow.constants.kEndState:j.end(function(){j=k.pop(),j?c(a.value,!1,function(a){b(a)}):X._.isFunction(o)?o(a):b(a)});break;case X.flow.constants.kErrorState:default:X._.isFunction(q)&&q(a)}}function e(a,b,c,d,e){if(c=c||{},j){var f=X.getAllDataInModel(h.getCurrentFlowScopeName());b=X._.extend(X._.extend({},f),b)}l.resolve(a).then(function(f){j&&k.push(j);try{j=new X.flow.Flow(a,f),j.__ref=d}catch(i){return void e(g("No Flow found for flow reference: "+a))}var l={path:h.getStateToCurrentFlow(d),nodeName:d};c.context=n,j.init(b,c,l,e)}).fail(function(a){X.publishException(a),e(g(a.msg))})}function f(a){X.publishException("X.flow.controller",a,X.log.ERROR)}function g(a){return{state_type:X.flow.constants.kErrorState,error:new X.Exception("X.flow.controller",a,X.log.ERROR)}}var h={start:function(a,b,c,d){var e=new X.flow.NavigationObject(a,b,c);this.navigateTo(e,d)},navigateTo:function(a,d){if(!d)return void f("navigateTo() called without callback");if(!a)return void d(g("No pathElements passed to navigateTo"));j=null,k=[];var h=a[0],i=a[a.length-1];return h instanceof X.flow.NavigationObject?i instanceof X.flow.NavigationObject?void(h===i?e(h.nodeName,h.inputVars,h.options,h.nodeName,function(a){a?d(a):c(null,!1,function(a){d(a)})}):e(h.nodeName,h.inputVars,h.options,h.nodeName,function(e){e?d(e):j.onStart(function(){b(1,a,function(a){a?d(a):c(i.nodeName,!0,function(a){d(a)})})})})):void d(g("navigateTo : end node is not a NavigationObject Object")):void d(g("navigateTo : Start node is not a NavigationObject Object"))},getNextView:function(a,b){return b?a?void c(a,!1,function(a){b(a)}):void b(g("No response passed to getNextView")):void f("getNextView() called without callback")},pause:function(){m=!0},resume:function(a,b){m=!1,a?c(a,!1,function(a){b(a)}):j.restoreToLastView(b)},getStateToCurrentFlow:function(a){for(var b=[],c=0;c<k.length;c++)b.push({nodeName:k[c].getNodeName(),id:k[c].getId()});return b.push({nodeName:a,id:j.getId()}),b},getCurrentFlowVariable:function(a){return j?j.getFlowVariable(a):void 0},setCurrentFlowVariable:function(a,b){j&&j.setFlowVariable(a,b)},getCurrentFlowScopeName:function(){return j?j.getflowScopedModelName():void 0},isBusy:function(){return j&&j.isBusy()?(X.trace("current flow is busy waiting for asynchronous functionality to complete",X.log.WARN),j.isBusy()):!1},getId:function(){return i}},i=X.utils.uuid(),j=null,k=[],l=X.getComponent(X.constants.interfaces.kFlowResolver),m=!1,n=a.context||"",o=a.onEndCB||function(){},p=a.onModalCB||function(){},q=a.onErrorCB||function(){};return h},X.flow.NavigationObject=function(a,b,c){this.nodeName=a,this.inputVars=b||null,this.options=c||null},X._.extend(X.registry,{registerFlow:function(a,b,c){return this._register(X.constants.registry.kFlows,a,b,c)},getFlow:function(a){return this._get(X.constants.registry.kFlows,a)},getFlows:function(){return this._getAll(X.constants.registry.kFlows)}}),X.validation={},X._.extend(X,{attach:function(a,b){a=X.utils.get$(a),a.length||(a=X.$("body")),X.validation.binder.bindFormatters(a,b||{}),X.validation.binder.bindValidators(a,b||{})},detach:function(a){a=X.utils.get$(a),a.unbind()},setValidationOptions:function(a){a=a||{};var b={validationOptions:a};X.setOptions(b)},setFormatOptions:function(a){a=a||{};var b={formatOptions:a};X.setOptions(b)},registerInputStrategy:function(a,b){X.registry.registerStrategy(a,b)},overrideInputStrategy:function(a,b){X.registry.overrideStrategy(a,b)},registerValidationRenderer:function(a){X._.isObject(a)&&X._.isFunction(a.show)&&X._.isFunction(a.hide)?X.registerComponent(X.constants.interfaces.kValidationRenderer,a):X.publishException("X.registerValidationRenderer: invalid Renderer - no show or hide function")},validateSection:function(a,b){return X.validation.engine.validateAll(a,b)},validateElement:function(a,b){return X.validation.engine.validateField(a,b)},getErrorList:function(a){return X.validation.engine.getErrorList(a)},removeErrorTips:function(a){X.validation.engine.hideErrorTooltips(a)},hasErrorToolTips:function(a){return X.validation.engine.hasErrorToolTips(a)},showErrorMsg:function(a,b,c){return X.validation.engine.showErrorMsg(a,b,c)},formatElement:function(a){var b=a.data("formatter");b||(b=a.attr("data-format"),a.data("formatter",b)),a.format(X.$.Event("keydown",{keyCode:38}))}}),X.$.ready(function(){var a,b;X.setDate=function(c){c instanceof Date?a=c.getTime():"number"==typeof c&&(a=c),b=(new Date).getTime()},X.getDate=function(){var c=(new Date).getTime()-b;return new Date(a+c)},X.$.ajax({type:"HEAD",url:"",success:function(b,c,d){a=new Date(d.getResponseHeader("Date")).getTime()},error:function(b,c,d){a=new Date(b.getResponseHeader("Date")).getTime()}}),b=(new Date).getTime()}),X.constants=X.utils.mergeObjects(X.constants,{events:{kValidationFailed:"validationFailed"},jqEvents:{kAutoformat:"xinch.autoformat"},interfaces:{kValidationRenderer:"validationRenderer"},registry:{kInputStrategies:"inputStrategies"}}),X._.extend(X.options,{validationOptions:{tooltipPosition:"top",hideOnFocus:!1,showOnlyOne:!1,showMultipleErrorsPerInput:!1,validateOnBlur:!1,suppressErrors:!1,validateOnBack:!1,validateOnJump:!1,useValidator:!0},formatOptions:{useFormatter:!0,formatEvent:["keyup","blur","paste"],ignoreKeyCodes:[9,16],autoFormat:!1}}),X._.extend(X.registry,{registerStrategy:function(a,b,c){if(X._.isObject(b)||X.publishException("X.validation.strategies","Invalid strategy definition - must be an object or instance of X.validation.BaseStrategy : '"+b+"'"),!(b instanceof X.validation.BaseStrategy)){var d=X.validation.BaseStrategy.extend(b);b=new d,d=null}return b._strategyName=a,this._register(X.constants.registry.kInputStrategies,a,b,c)},overrideStrategy:function(a,b){var c=this.getStrategy(a);c?(X.$.extend(c,b),X.trace("X.validation.strategies: overriding "+a)):X.publishException("X.validation.strategies","overrideStrategy: "+a+" does not exist - not overriding",X.log.WARN)},getStrategy:function(a){return this._get(X.constants.registry.kInputStrategies,a)},getStrategies:function(){return this._getAll(X.constants.registry.kInputStrategies)}}),X.validation.BaseStrategy=X.Class.extend({ignoreKeyCodesOnMask:[8,46,127],exceptions:null,allowException:!1,regex:null,defaultMessage:null,validateIfEmpty:!1,getError:function(a,b){var c=a.prop("validate"),d=c&&c[this._strategyName]&&c[this._strategyName].options.message?c[this._strategyName].options.message:this.defaultMessage||b;return X.utils.evaluateSimpleOperand(d)},construct:function(){this.allowException=!1,this.maskChar="#",this._strategyName=""},validate:function(a){var b=a.val();if(!(this.allowException&&this.exceptions&&"object"==typeof this.exceptions&&this.containedInExceptions(b))&&this.regex){var c=new RegExp(this.regex);if(!c.test(b))return this.getError(a,"Invalid Entry")}},formatAgainstMask:function(a,b,c){var d=b.length,e=0,f=this.mask,g=this,h=a.caret();X._.contains(this.ignoreKeyCodesOnMask,c.keyCode)||this.allowException&&this.exceptions&&"object"==typeof this.exceptions&&this.containedInExceptions(b,!0)||(h=h?h.end:0,b.replace(/\d/g,function(){var a=arguments[0];return f=f.replace(g.maskChar,a),arguments[0]}),f=f.split(this.maskChar)[0],e=f.length,this.setFormattedValue(a,f,c,d==e?h:h+(e-d)))},setFormattedValue:function(a,b,c,d){a.isTextInput()?a.val(b):a.isUserInputElement()||a.text(b),X._.isNumber(d)&&c&&"blur"!==c.type&&setTimeout(X.$.proxy(X.$.fn.caret,a,d),0)},containedInExceptions:function(a,b){var c=!1;if(this.exceptions){a&&(a=a.toLowerCase(),a=a.replace(/ /g,""));for(var d=0;d<this.exceptions.length;d++){var e=this.exceptions[d].toLowerCase();if(e=e.replace(/ /g,""),a===e){c=!0;break}if(b&&0===e.indexOf(a)){c=!0;break}}}return c}}),X.validation.defaultStrategies={required:{validateIfEmpty:!0,validate:function(a){var b=this.validateAgainstType(a);return b?this.getError(a,b):void 0},validateAgainstType:function(a){switch(a.prop("type")){case"text":case"password":case"textarea":case"file":default:if(!a.val())return"This field is required";break;case"checkbox":if(!a.prop("checked"))return"This checkbox is required";break;case"radio":var b=X.$("body"),c=a.attr("name");if(0===b.find("input[name='"+c+"'][type=radio]:checked").size())return"Please select an option";break;case"select-one":if(!a.val())return"This field is required";break;case"select-multiple":if(!a.find("option:selected").val())return"This field is required"}}},requiredIf:{validateIfEmpty:!0,validate:function(a,b){var c=X.registry.getStrategy("required"),d=c.validateAgainstType(a);return null!==b&&"undefined"!=typeof b&&""!==b&&d?this.getError(a,d):void 0}},requiredIfExpression:{validateIfEmpty:!0,validate:function(a,b){var c=X.registry.getStrategy("required"),d=c.validateAgainstType(a);return b===!0&&d?this.getError(a,d):void 0}},groupRequired:{validateIfEmpty:!0,validate:function(a,b){var c=(a.val(),X.$("input[data-validate*='groupRequired'][data-validate*='"+b+"']").filter(":visible"));c=c.filter(function(){return!this.id.match(/groupRequiredMultiple/)});var d=0;return X.$.each(c,function(){0!==this.value.length&&d++}),d>1?this.getError(a,"Only one field can be entered"):0===d?this.getError(a,"One of these fields is required"):void 0}},groupRequiredMultiple:{validateIfEmpty:!0,validate:function(a,b){var c=(a.val(),X.$("input[data-validate*='groupRequiredMultiple'][data-validate*='"+b+"']").filter(":visible")),d=0;return X.$.each(c,function(){0!==this.value.length&&d++}),0===d?this.getError(a,"One or more of these fields is required"):void 0}},maxLength:{validate:function(a,b){var c=a.val();return b=parseInt(b,10),isNaN(b)&&X.publishException("X.defaultStrategies.maxLength","maxLength validation set with non numeric arguement of: "+b),this._max=b,c.length>b?this.getError(a,"Maximum "+b+" characters allowed"):void 0},format:function(a,b,c){c=parseInt(c,10),isNaN(c)&&X.publishException("X.defaultStrategies.maxLength","maxLength validation set with non numeric arguement of: "+c),!isNaN(c)&&X._.isNumber(c)&&((a.is("input")||a.is("textarea"))&&a.val().length>=c?a.val(a.val().slice(0,c)):a.text().length>=c&&a.text(a.text().slice(0,c)))}},minLength:{validate:function(a,b){var c=a.val();return b=parseInt(b,10),isNaN(b)&&X.publishException("X.defaultStrategies.minLength","minLength validation set with non numeric arguement of: "+b),X._.isNumber(b)&&!isNaN(b)&&c.length<b?this.getError(a,"Minimum "+b+" characters required"):void 0}},exactLength:{validate:function(a,b){var c=a.val();return b=parseInt(b,10),isNaN(b)&&X.publishException("X.defaultStrategies.exactLength","exactLength validation set with non numeric arguement of: "+b),X._.isNumber(b)&&!isNaN(b)&&c.length!=b?this.getError(a,"Value must be "+b+" characters"):void 0},format:function(a,b,c){c=parseInt(c,10),isNaN(c)&&X.publishException("X.defaultStrategies.exactLength","exactLength validation set with non numeric arguement of: "+c),a.is("input")&&X._.isNumber(c)&&!isNaN(c)?a.val().length>=c&&a.val(a.val().slice(0,c)):a.text().length>=c&&X._.isNumber(c)&&!isNaN(c)&&a.text(a.text().slice(0,c))}},max:{validate:function(a,b){var c=a.val().replace(/\,/g,"");return b=parseFloat(b),c=parseFloat(c),(isNaN(b)||!X._.isNumber(b))&&X.publishException("X.defaultStrategies.max","max validation set with non numeric arguement of: "+b),isNaN(c)||!X._.isNumber(c)||parseFloat(c)>parseFloat(b)?this.getError(a,"Maximum value is "+b):void 0}},min:{validate:function(a,b){var c=a.val().replace(/\,/g,"");return b=parseFloat(b),c=parseFloat(c),isNaN(b)&&X.publishException("X.defaultStrategies.min","min validation set with non numeric arguement of: "+b),isNaN(c)||!X._.isNumber(c)||parseFloat(c)<parseFloat(b)?this.getError(a,"Minimum value is "+b):void 0}},multipleOf:{validate:function(a,b){var c=parseFloat(a.val().replace(/\,/g,""));return b=parseFloat(b),(!X._.isNumber(b)||isNaN(b))&&X.publishException("X.defaultStrategies.min","min validation set with non numeric arguement of: "+b),isNaN(c)||!X._.isNumber(c)||parseFloat(c)%parseFloat(b)!==0?this.getError(a,"Must be a multiple of "+b):void 0}},same:{validate:function(a,b,c,d){var e=a.val(),f=X.$("#"+b),g=f.val()?f.val():f.text();return d&&e.toLowerCase()!==g.toLowerCase()?this.getError(a,"Field must be same as "+c):d||e===g?void 0:this.getError(a,"Field must be same as "+c+" (Case Sensitive)")}},sameTrimmed:{validate:function(a,b,c,d){var e=X.$.trim(a.val()),f=X.$("#"+b),g=f.val()?f.val():f.text();return g=X.$.trim(g),d&&e.toLowerCase()!==g.toLowerCase()?this.getError(a,"Field must be same as "+c):d||e===g?void 0:this.getError(a,"Field must be same as "+c+" (Case Sensitive)")}},notSame:{validate:function(a,b,c,d){var e=a.val(),f=X.$("#"+b),g=f.val()?f.val():f.text();return d&&e.toLowerCase()===g.toLowerCase()?this.getError(a,"Field cannot be same as "+c):d||e!==g?void 0:this.getError(a,"Field cannot be same as "+c+" (Case Sensitive)")}},notSameTrimmed:{validate:function(a,b,c,d){var e=X.$.trim(a.val()),f=X.$("#"+b),g=f.val()?f.val():f.text();return g=X.$.trim(g),d&&e.toLowerCase()===g.toLowerCase()?this.getError(a,"Field cannot be same as "+c):d||e!==g?void 0:this.getError(a,"Field cannot be same as "+c+" (Case Sensitive)")}},equalsVal:{validate:function(a,b){var c=a.val();return c!==b+""?this.getError(a,"Value must be "+b):void 0}},notEqualsVal:{validate:function(a,b){var c=a.val();return c===b+""?this.getError(a,"Value cannot be "+b):void 0}},email:{regex:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,getError:function(a){return this._super(a,"Invalid email address")}},ssn:{exceptions:["applied for","died","tax exempt","LAFCP","unknown"],defaultRegex:/^\d\d\d\-\d\d\-\d\d\d\d$/,altRegex:/^\d\d\-\d\d\d\d\d\d\d$/,defaultMask:"###-##-####",altMask:"##-#######",getError:function(a,b){return this._super(a,this.allowException?"Invalid SSN":"Invalid SSN, must be "+this.mask)},validate:function(a,b,c){var d=a.val();this.allowException=b,this.regex=this.defaultRegex,this.mask=this.defaultMask,b&&d.match(/^\d\d\-/)&&(this.regex=this.altRegex,this.mask=this.altMask);var e=this._super(a);if(!e&&c&&!b){var f=!1,g=d.replace(/[^0-9]/g,""),h=g.substr(0,3),i=g.substr(3,2),j=g.substr(5,4);900>h&&0!==h&&0!==i&&0!==j?f=!0:h>899&&i>69&&81>i&&(f=!0),f||(e="Invalid Social security number")}return e},format:function(a,b,c){var d=a.val()||a.text();""!==d&&(this.allowException=c,this.mask=this.defaultMask,c&&d.match(/^\d\d\-/)&&(this.mask=this.altMask),this.formatAgainstMask(a,d,b))}},regex:{validate:function(a,b,c){return this.errorMsg=c,this.regex=new RegExp(b),this._super(a)},getError:function(a){return this._super(a,this.errorMsg)}},date:{exceptions:["various","inherit","inherited","continue","continues","none"],defaultMask:"MM/DD/YYYY",getError:function(a){return this._super(a,"Invalid '"+this.mask+"' date")},validate:function(a,b,c){function d(a,b,c){return a=parseInt(a,10),b=parseInt(b,10),c=parseInt(c,10),!c||a||b?a&&1>a||a>12?!1:b&&1>b||b>31?!1:(4==a||6==a||9==a||11==a)&&b>30?!1:2==a&&b>29?!1:b&&2==a?c%4===0&&c%100!==0||c%400===0?29>=b:29>b:!0:c>=1900&&2100>c}var e=a.val();"boolean"==typeof b?(this.allowException=b,this.mask=c||this.defaultMask):"boolean"==typeof c?(this.allowException=c,this.mask=b||this.defaultMask):(this.mask=b||this.defaultMask,this.allowException=!1);var f,g,h;switch(this.mask){case"MM/YYYY":this.regex=/^(?:0?[1-9]|1[0-2])\/(?:19\d\d|20\d\d)$/;var i=e.split("/");f=i[0],h=i[1];break;case"MM/YY":this.regex=/^(?:0?[1-9]|1[0-2])\/(\d\d)$/,i=e.split("/"),f=i[0],h=i[1];break;case"YYYY":this.regex=/^(?:19\d\d|20\d\d)$/,h=e;break;case"YYYY-MM-DD":this.regex=/^(?:19\d\d|20\d\d)\-(0?[1-9]|1[0-2])\-(0?[1-9]|[12][0-9]|3[01])$/,i=e.split("-"),f=i[1],g=i[2],h=i[0];break;case"MM/DD":this.regex=/^(?:(?:0?[1-9]|1[0-2])(\/|-)(?:0?[1-9]|[12][0-9]|3[01]))$/,i=e.split("/"),f=i[0],g=i[1];break;case"":case"MM/DD/YYYY":default:this.regex=/^(?:(?:0?[1-9]|1[0-2])(\/|-)(?:0?[1-9]|[12][0-9]|3[01]))(\/|-)(?:19\d\d|20\d\d)$/,i=e.split("/"),f=i[0],g=i[1],h=i[2]}var j=d(f,g,h)?null:"Invalid date range";return j||(j=this._super(a)),j?this.getError(a,j):void 0},format:function(a,b,c,d){var e,f=a.val()||a.text();if(""!==f){this.allowException=d,c=c||this.defaultMask,this.mask=c,this.mask=this.mask.replace(/[A-Za-z]/gi,"#"),e=f;var g=0,h=a.caret();if(c.indexOf("YYYY")>-1&&e.charAt(6)&&e.charAt(7)&&"/"===e.charAt(5)&&!e.charAt(8)){var i=e.substr(6,2);if("19"!==i&&"20"!==i){var j=parseInt("20"+i,10),k=j-X.getDate().getFullYear();k>2&&(j-=100),e=e.slice(0,5)+j.toString(),this.formatAgainstMask(a,e,b)}}var l=c.indexOf("MM");if(l>-1&&e.charAt(l)&&"/"===e.charAt(l+1)){var m="0"+e.charAt(l);X._.contains(this.ignoreKeyCodesOnMask,b.keyCode)||g++,e=e.substring(0,l)+m+e.substring(l+1)}var n=c.indexOf("DD");if(n>-1&&e.charAt(n)&&"/"===e.charAt(n+1)){var o="0"+e.charAt(n);X._.contains(this.ignoreKeyCodesOnMask,b.keyCode)||g++,e=e.substring(0,n)+o+e.substring(n+1)}this.formatAgainstMask(a,e,b),g>0&&a.caret(h.end+g)}}},before:{validate:function(a,b,c){var d=a.val();try{var e,f=d.toDate();switch(b){case"today":case"now":e=X.getDate(!0);break;default:e=b.toDate()}var g=!0;return g=c?f.yyyymmdd()<=e.yyyymmdd():f.yyyymmdd()<e.yyyymmdd(),g?null:this.getError(a,"Date entered must be"+(c?" on or":"")+" before "+b)}catch(h){return}}},after:{validate:function(a,b,c){var d=a.val();try{var e,f=d.toDate();switch(b){case"today":case"now":e=X.getDate(!0);break;default:e=b.toDate()}var g=!0;return g=c?f.yyyymmdd()>=e.yyyymmdd():f.yyyymmdd()>e.yyyymmdd(),g?null:this.getError(a,"Date entered must be"+(c?" on or":"")+" after "+b)}catch(h){return}}},phone:{regex:/^\(\d\d\d\) \d\d\d[\-]\d\d\d\d$/,defaultMask:"(###) ###-####",getError:function(a){return this._super(a,"Invalid phone number, must be "+this.mask)},validate:function(a,b){var c=a.val();this.mask=b||this.defaultMask;var d=this.mask.replace(/#/g,"\\d").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\./g,"\\.");d="^"+d+"$",this.regex=new RegExp(""+d);var e=this._super(a);return e||/[1-9]/.test(c)!==!1?e:"Phone number can't be all zeros."},format:function(a,b,c){var d=a.val()||a.text();""!==d&&(this.mask=c||this.defaultMask,this.formatAgainstMask(a,d,b))}},number:{regex:/^[\-\+]?(\d+(\,\d{3})*\.?\d{0,9}|\.\d{1,9})$/,getError:function(a){return this._super(a,"Invalid number")},validate:function(a,b){b=b||"100";var c="[\\-\\+]?(\\d+(,\\d{3})*\\.?\\d{0,PRE}|\\.\\d{1,PRE})";return c=c.replace(/PRE/g,b),c="^"+c+"$",this.regex=new RegExp(""+c),this._super(a)},format:function(a,b,c,d){var e=a.val()||a.text(),f=e.length,g=0;if(""!==e){var h=a.caret();h=h?h.end:0;var i="-"===e.charAt(0);e=e.replace(/[^0-9.]/gi,""),i&&(e="-"+e);var j=e.split(".");if(j[0]=j[0].replace(/0*(\d+)/,"$1"),j[0]=j[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),X._.isUndefined(j[1])||(j[1]=j[1].substr(0,c),j=[j[0],j[1]]),b.type==X.constants.jqEvents.kAutoformat||d&&"blur"===b.type){j[1]||(j[1]="");for(var k=j[1].length;c>k;k++)j[1]+="0"}e=j.join("."),g=e.length,this.setFormattedValue(a,e,b,f==g?h:h+(g-f))}}},numberOnly:{regex:/^[0-9]+$/,getError:function(a){return this._super(a,"Value is not a number")},format:function(a,b){var c=a.val()||a.text();if(""!==c)return 0===c.replace(/[0-9]/gi,"").length?c:void this.setFormattedValue(a,c.replace(/[^0-9]/g,""))}},alpha:{regex:/^[a-zA-Z]*$/,getError:function(a){return this._super(a,"Value must be all letters")},validate:function(a,b){return this.regex=b?/^[a-zA-Z\s]*$/:this.regex,this._super(a)},format:function(a,b,c){var d=a.val()||a.text(),e=/[^a-zA-Z\s]/g;this.setFormattedValue(a,d.replace(e,""))}},alphaNumeric:{regex:/^[a-zA-Z0-9]*$/,getError:function(a){return this._super(a,"Should be alphanumeric")},validate:function(a,b){return this.regex=b?/^[a-zA-Z0-9\s]*$/:this.regex,this._super(a)},format:function(a,b,c){var d=a.val()||a.text(),e=c?/[^a-zA-Z0-9\s]/g:/[^a-zA-Z0-9]/g;this.setFormattedValue(a,d.replace(e,""))}},upperCase:{getError:function(a){return this._super(a,"Should be all upper case")},validate:function(a){var b=a.val(),c=b===b.toUpperCase();return c?null:this.getError(a)},format:function(a,b){var c=a.val()||a.text();this.setFormattedValue(a,c.toUpperCase())}},lowerCase:{getError:function(a){return this._super(a,"Should be all lower case")},validate:function(a){var b=a.val(),c=b===b.toLowerCase();return c?null:this.getError(a)},format:function(a,b){var c=a.val()||a.text();this.setFormattedValue(a,c.toLowerCase())}},maskedNumber:{regex:/^$/,defaultMask:"",getError:function(a){return this._super(a,"Invalid input, format must be "+this.mask)},validate:function(a,b){a.val();this.mask=b||this.defaultMask;var c=this.mask.replace(/([^a-zA-Z0-9#])/g,"\\$1");return c=c.replace(/#/g,"\\d"),c="^"+c+"$",this.regex=new RegExp(""+c),this._super(a)},format:function(a,b,c){var d=a.val()||a.text();""!==d&&(this.mask=c?c:this.defaultMask,this.formatAgainstMask(a,d,b))}},zip:{regex:/^\d{5}(\-\d{4})?$/,
fivedigitMask:"#####",defaultMask:"#####-####",validate:function(a,b){var c=a.val();return this.mask=this.defaultMask,b&&10!=c.length?this.getError(a,"Invalid zip code, must be #####-####"):5!==c.length&&10!==c.length?this.getError(a,"Invalid zip code, must be #####  or  #####-####"):void 0},format:function(a,b){var c=a.val();""!==c&&(this.mask=c.length>5?this.defaultMask:this.fivedigitMask,this.formatAgainstMask(a,c,b))}},creditCard:{defaultMask:"################",validate:function(a){var b=a.val().replace("-","").replace(/\s/g,""),c=b.slice(0,2);if("34"===c||"37"===c){if(15!==b.length)return this.getError(a,"Invalid Credit Card Number");b="0"+b}else if(16!==b.length)return this.getError(a,"Invalid Credit Card Number");for(var d=0,e=0,f=b.length-1;f>=0;f--)d=parseInt(b.charAt(f),10),f%2?e+=d:(d=2*d,d>=10?(e+=Math.floor(d/10),e+=d%10):e+=d);return e%10!==0?this.getError(a,"Invalid Credit Card Number"):void 0},format:function(a,b){var c=a.val(),d=c.slice(0,2);"34"===d||"37"===d?this.mask="###############":this.mask=this.defaultMask,""!==c&&this.formatAgainstMask(a,c,b)}},rtn:{validate:function(a){var b=a.val(),c=!1;if(b.match("[-\\d]+")){var d=b.replace(/-/,"");if(9==d.length){var e=d.substring(0,2).toNum();if(!(e>=1&&12>=e||e>=21&&32>=e))return c=!1,this.getError(a,"Invalid Routing Transit Number");for(var f=0,g=[3,7,1,3,7,1,3,7],h=0;h<g.length;h++)f+=g[h]*d.charAt(h).toNum();var i=d.charAt(8).toNum(),j=(10-f%10)%10;i==j&&(c=!0)}}return c?void 0:this.getError(a,"Invalid Routing Transit Number")}}},X.validation.binder={bindFormatters:function(a,b){if(b=b||X.options.formatOptions,b.useFormatter){var c=X.utils.get$(a),d=X.$(c).find("[data-format]");X.$.each(d,function(){var a=X.$(this),c=X.utils.jsonSerializer.toJSON(a.attr("data-format-options"),!0)||{};c=X.utils.mergeObjects(b,c);var d=c.formatEvent,e=c.ignoreKeyCodes,f=X._.isArray(d)?d.join(" "):d;a.isTextInput()&&f&&a.on(f,function(b){if(!X._.contains(e,b.keyCode)){var c=a.val();a.format(b),a.val()!=c&&a.trigger(X.constants.jqEvents.kAutoformat)}});var g=c.autoFormat;(g||!a.isUserInputElement())&&a.format(X.$.Event(X.constants.jqEvents.kAutoformat))})}},bindValidators:function(a,b){if(b=b||X.options.validationOptions,b.useValidator){var c=X.utils.get$(a);X.$(c).find("[data-validate]").each(function(){var a=X.$(this),c=X.utils.jsonSerializer.toJSON(a.attr("data-validate-options"),!0)||{};c=X.utils.mergeObjects(b,c),c.validateOnBlur===!0&&X.validation.engine.setValidateOnBlur(a,c,!0)})}}},X.validation.renderer=function(){var a=X.$,b=X.utils,c={show:function(d,e,f){var g="";f.showMultipleErrorsPerInput?X._.each(e,function(a){g+=a+"<br/>"}):g=e[0];var h,i,j=d.offset().left,k=d.offset().top,l=j+d.width();d.addClass("xValidationError"),d.attr("aria-invalid","true");var m=f.tooltipPosition||"top",n=f.hideOnFocus;switch(m){case"right":i="errorTooltipArrowLeft";break;case"bottom":i="errorTooltipArrowUp";break;default:i="errorTooltipArrowDown"}if(d.attr("hasErrorTip",!0),d.data("errorTooltip")&&d.data("errorTooltip").is(":visible"))h=d.data("errorTooltip"),h.html(g+"<div class='"+i+"' />");else{var o=b.uuid(!0);h=a("<div class='errorTooltip' role='alert' id='"+o+"'>"+g+"<div class='"+i+"'></div></div>"),h.appendTo("body").hide().fadeIn(120),d.data("errorTooltip",h),d.attr("aria-describedby",o)}var p=X.getComponent(X.constants.interfaces.kModalWindow);switch(p&&X.getContainingViewport(d)===p.getViewPortId()&&h.addClass("modalTip"),m){case"right":h.css("left",l+14),h.css("top",k+(d.height()-h.height())/2);break;case"bottom":h.css("left",j),h.css("top",k+d.height()+9);break;default:h.css("left",j),h.css("top",k-h.height()-7)}h.off("click").on("click",function(){c.hide(a(d))}),n&&!d.prop("clickHandlerSet")&&(d.prop("clickHandlerSet",!0),d.on("click",function(){c.hide(a(this))}))},hide:function(a){a.removeClass("xValidationError");var b=a.data("errorTooltip");b&&b.fadeOut(100,function(){b.remove()}),a.removeData("errorTooltip"),a.removeAttr("hasErrorTip"),a.removeAttr("aria-invalid"),a.removeAttr("aria-describedby")}};return c},X.registerComponent(X.constants.interfaces.kValidationRenderer,new X.validation.renderer),X.validation.engine=function(){function a(){return X.getComponent(X.constants.interfaces.kValidationRenderer)}function b(a){e.isElementInView(a)||a.scrollTo(c(window).height()/2,200),a.focus().select()}var c=X.$,d=X._,e=X.utils,f={validateAll:function(a,b){var d=e.get$(a),g=e.mergeObjects(X.options.validationOptions,b||{}),h=!0,i=g.showOnlyOne;return this.hideErrorTooltips(d),c(d).find("[data-validate]").not(":hidden").not(":disabled").each(function(a,b){b=c(b);var d=h;return h=f.validateField(b,g,d)?h:!1,i&&!h?!1:void 0}),h},validateField:function(d,f,g){var h=e.get$(d),i=e.mergeObjects(X.options.validationOptions,f||{}),j=h.attr("data-validate-options");j=e.jsonSerializer.toJSON(j,!0)||{},i=e.mergeObjects(i,j),this.setValidateOnBlur(h,i,!0);var k=i.suppressErrors===!0,l=h.validate();if(l.length>0){if("radio"==h.prop("type")){var m=h.prop("name"),n=c("body").find("input[name='"+m+"'][type=radio]:first");if(h[0]!=n[0])return i.__returnErrorObj?{$el:h,errorList:l}:!1}return k||(a().show(h,l,i),g&&b(h)),i.__returnErrorObj?{$el:h,errorList:l}:!1}return a().hide(h),!0},getErrorList:function(a){a=a?e.get$(a):c("body");var b=[];return c(a).find("[data-validate]").not(":hidden").not(":disabled").each(function(a,e){e=c(e);var g=f.validateField(e,{suppressErrors:!0,__returnErrorObj:!0});d.isObject(g)&&b.push(g)}),b},hasErrorToolTips:function(a){return a=a?e.get$(a):c("body"),a.find("[hasErrorTip]").length>0},hideErrorTooltips:function(b){b=b?e.get$(b):c("body"),b.find("[hasErrorTip]").each(function(b,d){a().hide(c(d))}),b.attr("hasErrorTip")&&a().hide(b)},setValidateOnBlur:function(a,b,d){var e=a.prop("validationBlurSet")===!0;e||(a.prop("validationBlurSet",!0),a.on("blur",function(){f.validateField(c(this),b)}))},showErrorMsg:function(b,c,d){b=e.get$(b),d=d||{},a().show(b,[c],d)}};return d.each(X.validation.defaultStrategies,function(a,b){X.registry.registerStrategy(b,a)}),f}(),X.validation.executor=function(){function a(a,b,e,f,g){var h=null,i=X.registry.getStrategy(f);if(!i)return void X.publishException("X.validation.strategies","Missing strategy: '"+f+"'",X.log.WARN);if(!i[a])return void X.publishException("X.validation.strategies","Missing action:"+a+" for strategy:"+f,X.log.WARN);var j=X.utils.getArrayOfArgs(g);try{if(a===c&&!b.val()&&!i.validateIfEmpty)return"";j.splice(0,0,b),a===d&&j.splice(1,0,e),h=i[a].apply(i,j)}catch(k){X.publishException("X.validation.strategies","Invalid "+a+" definition "+f+": "+g,X.log.WARN,k)}return h}var b={validate:function(b,d,e){return a(c,b,null,d,e)},format:function(b,c,e,f){return a(d,b,c,e,f)}},c="validate",d="format";return b}(),X.utils.extend_$({format:function(a){var b=X.$(this),c=b.attr("data-format");if(c){var d=X.constants.functionRegex.exec(c);X.validation.executor.format(b,a,d[1],d[3])}}}),X.utils.extend_$({validate:function(a){function b(a){var b={};a=X.utils.replaceCharWithinParenthesis(a,":","_colon_");var c=a.split(":");X._.each(c,function(a,b){c[b]=a.replace(/_colon_/g,":")});var e=X.constants.functionRegex.exec(c[0]);e&&(b.type=e[1],b.args=e[3]?e[3].replace(/_comma_/g,","):null),b.options={};for(var f=1;f<c.length;f+=1){var g=X.constants.functionRegex.exec(c[f]),h=g[1];b.options[h]=g[3]?g[3].replace(/_comma_/g,",").replace(/_colon_/g,":").removeQuotes():null}var i=d.prop("validate")||{};return i[b.type]=b,d.prop("validate",i),b}function c(a){a=a.replace(/(^\s*)|(\s*$)/g,""),a=a.replace(/(\s*,\s*)/g,","),a=X.utils.replaceCharWithinParenthesis(a,",","_comma_");var c=a.split(","),d=[];return X._.each(c,function(a,c){d.push(b(a))}),d}var d=this;if(!d.attr("data-validate"))return"";var e=d.attr("data-validate"),f=null,g=[],h=c(e);return X._.each(h,function(a){f=X.validation.executor.validate(d,a.type,a.args),f&&(X.publish(X.constants.events.kValidationFailed,d.get(0)),g.push(f))}),g}});
//# sourceMappingURL=mojo.min.js.map